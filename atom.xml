<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ç‹å°‘æ˜Ÿçš„ä¸ªäººåšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://wsxyeah.github.io/"/>
  <updated>2019-08-18T00:48:49.945Z</updated>
  <id>https://wsxyeah.github.io/</id>
  
  <author>
    <name>ç‹å°‘æ˜Ÿ</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Koltin ä¸­ Lambda å˜é‡æ•è·</title>
    <link href="https://wsxyeah.github.io/2019/08/18/lambda-captures-in-kotlin/"/>
    <id>https://wsxyeah.github.io/2019/08/18/lambda-captures-in-kotlin/</id>
    <published>2019-08-18T00:43:24.000Z</published>
    <updated>2019-08-18T00:48:49.945Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Java-ä¸­-Lambda-å˜é‡æ•è·"><a href="#Java-ä¸­-Lambda-å˜é‡æ•è·" class="headerlink" title="Java ä¸­ Lambda å˜é‡æ•è·"></a>Java ä¸­ Lambda å˜é‡æ•è·</h2><p>Java ä¸­ lambda çš„å˜é‡æ•è·æ˜¯å€¼çš„æ•è·ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æŠŠæ•è·çš„å˜é‡æ‹·è´ä¸€ä»½ï¼Œè¿™æ„å‘³ç€å¯¹äºæ ˆä¸Šçš„å˜é‡ï¼Œä½ å¦‚æœåœ¨ lambda ä¸­æƒ³å¯¹å…¶èµ‹å€¼ï¼Œå¯¹åŸå§‹å˜é‡æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥ Java å¹²è„†ç¦æ­¢è¿™æ ·åšï¼Œå¼ºåˆ¶ä½ å°†å…¶å£°æ˜ä¸º finalã€‚<br>å½“ç„¶å¦‚æœçœŸçš„éœ€è¦æ”¹å˜åŸå§‹çš„å€¼çš„è¯ï¼ŒIDE ä¼šæç¤ºä½ å¯ä»¥ç”¨ Atomic ç±»æˆ–è€…ä¸€ä¸ªå•å…ƒç´ çš„æ•°ç»„åŒ…è£…ä¸€ä¸‹ï¼Œè¿™æ ·æ•è·æ—¶æ˜¯å°† Atomic å¯¹è±¡æˆ–è€…æ•°ç»„å˜é‡æ‹·è´ä¸€ä»½ï¼Œè€Œä»–ä»¬æŒ‡å‘çš„æ•°æ®éƒ½æ˜¯å †ä¸Šçš„åŒä¸€ä»½æ•°æ®ã€‚</p><h2 id="Koltin-ä¸­-Lambda-å˜é‡æ•è·"><a href="#Koltin-ä¸­-Lambda-å˜é‡æ•è·" class="headerlink" title="Koltin ä¸­ Lambda å˜é‡æ•è·"></a>Koltin ä¸­ Lambda å˜é‡æ•è·</h2><p>éšä¾¿å†™ä¸ª demo åç¼–è¯‘ä¸‹å¯ä»¥å‘ç°å¦‚æœä½ åœ¨ lambda ä¸­å¯¹æ•è·çš„å˜é‡æœ‰èµ‹å€¼æ“ä½œï¼Œåœ¨ JVM å¹³å°ä¸Šç¼–è¯‘å™¨å°±ä¼šè‡ªåŠ¨å¸®ä½ æŠŠå˜é‡åŒ…è£…æˆä¸€ä¸ª Ref å¯¹è±¡ï¼ŒåŸç†è·Ÿä¸Šé¢æåˆ°çš„ Java ä¸­çš„è§£å†³æ–¹å¼æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ã€‚å‚è€ƒ <a href="https://github.com/JetBrains/kotlin/blob/master/libraries/stdlib/jvm/runtime/kotlin/jvm/internal/Ref.java" target="_blank" rel="noopener">Ref.java</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Java-ä¸­-Lambda-å˜é‡æ•è·&quot;&gt;&lt;a href=&quot;#Java-ä¸­-Lambda-å˜é‡æ•è·&quot; class=&quot;headerlink&quot; title=&quot;Java ä¸­ Lambda å˜é‡æ•è·&quot;&gt;&lt;/a&gt;Java ä¸­ Lambda å˜é‡æ•è·&lt;/h2&gt;&lt;p&gt;Java ä¸­
      
    
    </summary>
    
    
      <category term="kotlin" scheme="https://wsxyeah.github.io/tags/kotlin/"/>
    
  </entry>
  
  <entry>
    <title>Android Studio Apply Changes</title>
    <link href="https://wsxyeah.github.io/2019/08/06/android-studio-apply-changes/"/>
    <id>https://wsxyeah.github.io/2019/08/06/android-studio-apply-changes/</id>
    <published>2019-08-05T23:25:59.000Z</published>
    <updated>2019-08-05T23:51:11.310Z</updated>
    
    <content type="html"><![CDATA[<p>æ¢ç©¶ Android Studio 3.5 æ–°å¢çš„ <code>Apply Changes</code> åŠŸèƒ½ã€‚</p><ul><li><a href="https://medium.com/androiddevelopers/android-studio-project-marble-apply-changes-e3048662e8cd" target="_blank" rel="noopener">Android Studio Project Marble: Apply Changes</a></li><li><a href="https://www.zhihu.com/question/309772986" target="_blank" rel="noopener">Android Studio 3.5æä¾›çš„â€Apply Changesâ€œæ˜¯ä»€ä¹ˆåŸç†ï¼Ÿ</a></li><li><a href="https://android.googlesource.com/platform/tools/base/+/studio-master-dev/deploy/" target="_blank" rel="noopener">Source Code</a></li><li><a href="https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html" target="_blank" rel="noopener">JVM(TM) Tool Interface</a></li><li><a href="http://jm.taobao.org/2011/03/15/756/" target="_blank" rel="noopener">JVMTIå¼€å‘æ•™ç¨‹ä¹‹ä¸€ä¸ªç®€å•çš„Agent</a></li><li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-jpda2/index.html" target="_blank" rel="noopener">JVMTI å’Œ Agent å®ç°</a></li></ul><a id="more"></a><h2 id="Instant-Run"><a href="#Instant-Run" class="headerlink" title="Instant Run"></a><a href="https://medium.com/google-developers/instant-run-how-does-it-work-294a1633367f" target="_blank" rel="noopener">Instant Run</a></h2><ul><li>æ„å»ºè¿‡ç¨‹åŠ¨æ‰‹è„š</li><li>Apk é‡Œè—ç§è´§</li><li>è‡ªå®šä¹‰ ClassLoader çƒ­éƒ¨ç½²</li><li>å…¼å®¹æ€§ä¸€èˆ¬</li></ul><p><img src="https://miro.medium.com/max/1400/1*U2tXGUWaeDU7L3u9Z_U0fw.png" alt="Instant Run"></p><h2 id="Apply-Changes"><a href="#Apply-Changes" class="headerlink" title="Apply Changes"></a>Apply Changes</h2><ul><li>ä¸å…³å¿ƒæ„å»ºè¿‡ç¨‹ï¼Œåªå¯¹ apk åš diff</li><li>åŸºäº JVMTIï¼Œéœ€è¦ Android O+</li></ul><h3 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h3><ol><li>å¯¹è®¾å¤‡ä¸Šå®‰è£…çš„ apk ä¸æ–° apk åš diff</li><li>å°† diff æ¨åˆ°è®¾å¤‡ä¸Šå¹¶åº”ç”¨æ”¹åŠ¨</li></ol><h3 id="æ”¹åŠ¨ç±»å‹æ”¯æŒ"><a href="#æ”¹åŠ¨ç±»å‹æ”¯æŒ" class="headerlink" title="æ”¹åŠ¨ç±»å‹æ”¯æŒ"></a>æ”¹åŠ¨ç±»å‹æ”¯æŒ</h3><ol><li>ä»… res/assets æ”¹åŠ¨ï¼šåº”ç”¨æ”¹åŠ¨çš„èµ„æºï¼Œé‡å¯ Activity</li><li>ä»… dex æ”¹åŠ¨ï¼šæ”¹åŠ¨ä¸èƒ½å½±å“å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼ŒåŸºäº JVMTI è¿›è¡Œç±»çº§åˆ«çš„ hot swap</li><li>èµ„æºæ”¹åŠ¨ + dex æ”¹åŠ¨</li><li>å…¶ä»–æ”¹åŠ¨ï¼šä¸æ”¯æŒ</li></ol><h3 id="å¢é‡æ›´æ–°æµç¨‹"><a href="#å¢é‡æ›´æ–°æµç¨‹" class="headerlink" title="å¢é‡æ›´æ–°æµç¨‹"></a>å¢é‡æ›´æ–°æµç¨‹</h3><ol><li>è§£ææ–° apk çš„ zip entries</li><li>æ‹‰å–å·²å®‰è£…çš„ apk çš„ zip entries</li><li>å¯¹ä»¥ä¸Šä¸¤ä¸ªåˆ—è¡¨åš diffï¼Œå¾—å‡ºå˜æ›´æ–‡ä»¶çš„åˆ—è¡¨</li><li>æ ¹æ®æ–‡ä»¶åˆ—è¡¨ diff éªŒè¯æ˜¯å¦æ”¯æŒ apply changesï¼ˆæ˜¯å¦æ”¹åŠ¨ dexï¼Œèµ„æºä¹‹å¤–çš„å†…å®¹ï¼‰</li><li>æ ¹æ® diff è®¡ç®—ï¼ˆç²’åº¦ä¸º zip entry çº§åˆ«ï¼‰dirty mapï¼Œç”Ÿæˆ instructions &amp; patchã€‚<strong>æ³¨æ„è¿™é‡Œä¸éœ€è¦å…¨é‡æ‹‰å–å·²å®‰è£…çš„ apk</strong>ã€‚</li></ol><svg width="373" height="154" viewbox="0 0 373 154" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="52" y="1" width="55" height="64" fill="#C4C4C4"/><rect x="107" y="1" width="76" height="64" fill="#7A7A7A"/><rect x="183" y="1" width="76" height="64" fill="#C4C4C4"/><rect x="259" y="1" width="37" height="64" fill="#7A7A7A"/><rect x="296" y="1" width="76" height="64" fill="#C4C4C4"/><rect x="51.5" y="0.5" width="321" height="65" stroke="#B4B4B4"/><rect x="259" y="90" width="54" height="64" fill="#93C595"/><rect x="107" y="90" width="103" height="64" fill="#93C595"/><text fill="black" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="12" letter-spacing="0em"><tspan x="143" y="126.102">patch</tspan></text><text fill="black" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="12" letter-spacing="0em"><tspan x="0" y="62.1016">old apk</tspan></text><text fill="white" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="12" letter-spacing="0em"><tspan x="133" y="37.1016">dirty</tspan></text><text fill="white" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="12" letter-spacing="0em"><tspan x="266" y="37.1016">dirty</tspan></text><text fill="black" xml:space="preserve" style="white-space: pre" font-family="Roboto" font-size="12" letter-spacing="0em"><tspan x="271" y="126.102">patch</tspan></text><path d="M277.646 90.3536C277.842 90.5488 278.158 90.5488 278.354 90.3536L281.536 87.1716C281.731 86.9763 281.731 86.6597 281.536 86.4645C281.34 86.2692 281.024 86.2692 280.828 86.4645L278 89.2929L275.172 86.4645C274.976 86.2692 274.66 86.2692 274.464 86.4645C274.269 86.6597 274.269 86.9763 274.464 87.1716L277.646 90.3536ZM277.5 65L277.5 90L278.5 90L278.5 65L277.5 65Z" fill="black"/><path d="M144.646 90.3536C144.842 90.5488 145.158 90.5488 145.354 90.3536L148.536 87.1716C148.731 86.9763 148.731 86.6597 148.536 86.4645C148.34 86.2692 148.024 86.2692 147.828 86.4645L145 89.2929L142.172 86.4645C141.976 86.2692 141.66 86.2692 141.464 86.4645C141.269 86.6597 141.269 86.9763 141.464 87.1716L144.646 90.3536ZM144.5 65L144.5 90L145.5 90L145.5 65L144.5 65Z" fill="black"/></svg><ol start="6"><li>deltaPreInstallï¼šadb è°ƒç”¨ <code>cmd package install-create</code> åˆ›å»º sessionï¼Œ<code>install-write</code> å†™å…¥ instructions &amp; patch æ•°æ®ã€‚</li><li>å¯¹ dex ï¼ˆé‡Œçš„ç±»ï¼‰è¿›è¡Œ diffï¼Œå¾—åˆ°éœ€è¦ swap çš„ç±»åˆ—è¡¨ã€‚è¿™é‡Œæ³¨æ„ä¸¤ç‚¹ï¼š<br> ï¼ˆ1ï¼‰ç±»çš„ diff åªç”¨æ¯”è¾ƒ checksum<br> ï¼ˆ2ï¼‰dex é‡Œç±»çš„ä¿¡æ¯å…¶å®æ˜¯ä»æ•°æ®åº“å–çš„ï¼ˆé¢„å…ˆå†™è¿›å»çš„ï¼‰è€Œéæ‹‰å–è®¾å¤‡ä¸Šçš„ dexï¼Œ ( &gt;ï¹&lt;ã€‚)ï½ è¿™ä¸ªé—®é¢˜å¡äº†æˆ‘å¥½ä¹…ï¼Œå…¶å®æµç¨‹å›¾ä¸Šæœ‰å†™ã€‚</li><li>Swapï¼adb è°ƒç”¨ <code>installer</code> æ‰§è¡Œ swap</li><li>Commit install</li></ol><p><img src="https://miro.medium.com/max/2000/1*aD1y7EprEnSzM-3FwbUsRQ.png" alt="flow"></p><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/ZIP-64_Internal_Layout.svg/2560px-ZIP-64_Internal_Layout.svg.png" alt="zip"></p><h3 id="Swap-amp-JVMTI-Agent"><a href="#Swap-amp-JVMTI-Agent" class="headerlink" title="Swap &amp; JVMTI Agent"></a>Swap &amp; JVMTI Agent</h3><ol><li><code>installer</code> è¿›ç¨‹å¼€å¯ä¸€ä¸ª socket server</li><li>é€šè¿‡ <code>cmd activity attach-agent &lt;PROCESS&gt; &lt;FILE&gt;</code> attach agent åˆ°æŒ‡å®šè¿›ç¨‹</li><li>Attach æˆåŠŸåï¼Œagent é€šè¿‡ socket ä» <code>installer</code> è¯»å–æ•°æ®</li><li>InstrumentApplicationï¼š<ol><li><a href="https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html#SetEventCallbacks" target="_blank" rel="noopener">SetEventCallbacks</a>ï¼š<code>callbacks.ClassFileLoadHook = Agent_ClassFileLoadHook</code></li><li>åŠ è½½ instrumentation jar åŒ…</li><li><code>RetransformClasses</code>ï¼Œè§¦å‘å‰é¢è®¾ç½®çš„ <a href="https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html#ClassFileLoadHook" target="_blank" rel="noopener"><code>ClassFileLoadHook</code></a>ï¼šHook <code>ActivityThread.handleDispatchPackageBroadcast()</code>ï¼Œæ›´æ–°èµ„æºã€‚</li></ol></li><li>HotSwapï¼š<a href="https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html#RedefineClasses" target="_blank" rel="noopener">RedefineClasses</a></li></ol><h3 id="ä»£ç ç»“æ„"><a href="#ä»£ç ç»“æ„" class="headerlink" title="ä»£ç ç»“æ„"></a>ä»£ç ç»“æ„</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">agent/      JVMTI agent å®ç°ï¼Œç¼–è¯‘æˆ so æ–‡ä»¶ï¼Œæ‹·è´åˆ° app çš„ data ç›®å½•ä¸‹ï¼Œé€šè¿‡ JVMTI attach åˆ°å¯¹åº”çš„è¿›ç¨‹ä¸Šã€‚</span><br><span class="line">bench.sh</span><br><span class="line">common/</span><br><span class="line">deployer/   Android Studio ç«¯æ“ä½œæµç¨‹é€»è¾‘</span><br><span class="line">installer/  ç¼–è¯‘æˆäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®‰è£… apk æ—¶ä¼šè¢« push åˆ° /data/local/tmp/.studio/bin/installerï¼Œè·‘åœ¨è®¾å¤‡ç«¯ï¼Œç”± Android Studio é€šè¿‡ adb è°ƒç”¨ã€‚ç›®å‰æ”¯æŒä¸‰ä¸ªæ“ä½œï¼š`dump`ï¼Œ`swap`ï¼Œ`deltapreinstall`ã€‚</span><br><span class="line">proto/      PB å®šä¹‰</span><br><span class="line">summary.py</span><br><span class="line">test/</span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒé€»è¾‘å¯ä»¥å‚è€ƒ <a href="deployer/src/main/java/com/android/tools/deployer/Deployer.java">deployer/src/main/java/com/android/tools/deployer/Deployer.java</a> çš„ <code>swap</code> æ–¹æ³•ï¼Œååˆ†æ¸…æ™°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// Get the list of files from the local apks</span><br><span class="line">// Get the list of files from the installed app</span><br><span class="line">// Calculate the difference between them</span><br><span class="line">// Push the apks to device and get the remote paths</span><br><span class="line">// Verify the changes are swappable and get only the dexes that we can change</span><br><span class="line">// Compare the local vs remote dex files.</span><br><span class="line">// Do the swap</span><br><span class="line">// Update the database with the entire new apk.</span><br><span class="line">// Wait only for swap to finish</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¢ç©¶ Android Studio 3.5 æ–°å¢çš„ &lt;code&gt;Apply Changes&lt;/code&gt; åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/androiddevelopers/android-studio-project-marble-apply-changes-e3048662e8cd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Android Studio Project Marble: Apply Changes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/question/309772986&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Android Studio 3.5æä¾›çš„â€Apply Changesâ€œæ˜¯ä»€ä¹ˆåŸç†ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://android.googlesource.com/platform/tools/base/+/studio-master-dev/deploy/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Source Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JVM(TM) Tool Interface&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://jm.taobao.org/2011/03/15/756/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JVMTIå¼€å‘æ•™ç¨‹ä¹‹ä¸€ä¸ªç®€å•çš„Agent&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.ibm.com/developerworks/cn/java/j-lo-jpda2/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JVMTI å’Œ Agent å®ç°&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Java é‡Œ switch è¯­å¥å¯¹ String çš„æ”¯æŒ</title>
    <link href="https://wsxyeah.github.io/2018/09/14/java-strings-in-switch-statements/"/>
    <id>https://wsxyeah.github.io/2018/09/14/java-strings-in-switch-statements/</id>
    <published>2018-09-14T13:02:57.000Z</published>
    <updated>2018-09-14T13:32:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>Java é‡Œ switch è¯­å¥æ˜¯åœ¨ JDK 7 å¼€å§‹æ”¯æŒçš„ï¼Œç°åœ¨å¯ä»¥æ”¯æŒ <code>char, byte, short, int, Character, Byte, Short, Integer, String</code> ç±»å‹ã€‚</p><a id="more"></a><p>ä»Šå¤©è¯» flutter ä»£ç çš„æ—¶å€™æ— æ„é—´å‘ç° switch è¯­å¥å¯¹ String çš„æ”¯æŒæ˜¯é€šè¿‡ <code>hashCode</code> é…åˆ <code>equals</code> å®ç°çš„ ğŸ˜‚ã€‚</p><p><del>é‰´äº Blog å¥½ä¹…æ²¡æ›´æ–°äº†ï¼Œç‰¹åœ°æ¥æ°´ä¸€ç¯‡ã€‚</del>ä¸å¤šè¯´äº†ï¼Œçœ‹ä¸‹ä»£ç ã€‚</p><p>è¿™æ˜¯æºç ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (method.getName()) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"addView"</span>:</span><br><span class="line">            addView(args);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"removeView"</span>:</span><br><span class="line">            removeView(args);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"updateViewLayout"</span>:</span><br><span class="line">            updateViewLayout(args);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> method.invoke(mDelegate, args);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> e.getCause();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™æ˜¯åç¼–è¯‘è¿‡çš„ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    String var4 = method.getName();</span><br><span class="line">    <span class="keyword">byte</span> var5 = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">switch</span>(var4.hashCode()) &#123;</span><br><span class="line">    <span class="keyword">case</span> -<span class="number">1148522778</span>:</span><br><span class="line">        <span class="keyword">if</span> (var4.equals(<span class="string">"addView"</span>)) &#123;</span><br><span class="line">            var5 = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">931413976</span>:</span><br><span class="line">        <span class="keyword">if</span> (var4.equals(<span class="string">"updateViewLayout"</span>)) &#123;</span><br><span class="line">            var5 = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1098630473</span>:</span><br><span class="line">        <span class="keyword">if</span> (var4.equals(<span class="string">"removeView"</span>)) &#123;</span><br><span class="line">            var5 = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(var5) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">this</span>.addView(args);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">this</span>.removeView(args);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">this</span>.updateViewLayout(args);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> method.invoke(<span class="keyword">this</span>.mDelegate, args);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException var6) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var6.getCause();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Java é‡Œ switch è¯­å¥æ˜¯åœ¨ JDK 7 å¼€å§‹æ”¯æŒçš„ï¼Œç°åœ¨å¯ä»¥æ”¯æŒ &lt;code&gt;char, byte, short, int, Character, Byte, Short, Integer, String&lt;/code&gt; ç±»å‹ã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>è°ˆè°ˆ View çš„æ„é€ æ–¹æ³•ä»¬</title>
    <link href="https://wsxyeah.github.io/2018/01/03/view-constructors/"/>
    <id>https://wsxyeah.github.io/2018/01/03/view-constructors/</id>
    <published>2018-01-03T14:54:32.000Z</published>
    <updated>2018-05-13T04:45:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ Android ä¸­ï¼Œè¦å®ç°è‡ªå®šä¹‰ Viewï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿å·²æœ‰çš„ View æ¥å®ç°ï¼Œå¹¶ä¸”è¦å†™å¯¹åº”çš„æ„é€ æ–¹æ³•ã€‚</p><p>View æœ‰å››ä¸ªä¸»è¦çš„æ„é€ æ–¹æ³•ï¼Œç¬¬å››ä¸ªéœ€è¦åœ¨ API 21 ä»¥ä¸Šï¼Œä¸€èˆ¬è€Œè¨€æˆ‘ä»¬éƒ½ä¼šå®ç°å‰ä¸‰ä¸ªã€‚</p><ul><li><code>public View(Context context)</code></li><li><code>public View(Context context, @Nullable AttributeSet attrs)</code></li><li><code>public View(Context context, @Nullable AttributeSet attrs, int defStyleAttr)</code></li><li><code>public View(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes)</code></li></ul><a id="more"></a><p>ä¸‹é¢æ¥çœ‹ä¸€ç§å¸¸è§çš„å†™æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>(context, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>(context, attrs, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>(context, attrs, defStyleAttr, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TargetApi</span>(Build.VERSION_CODES.LOLLIPOP)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr, <span class="keyword">int</span> defStyleRes)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>(context, attrs, defStyleAttr, defStyleRes);</span><br><span class="line">init();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‰é¢å‡ ä¸ªæ„é€ æ–¹æ³•ä¸­è°ƒç”¨ thisï¼Œ å†åœ¨åé¢çš„æ„é€ æ–¹æ³•ä¸­ç»Ÿä¸€è°ƒç”¨ superã€‚è¿™ç§å†™æ³•çš„ç¡®å¾ˆå¸¸è§ï¼Œåœ¨å„ç§å¼€æºåº“ç”šè‡³ Android è‡ªå·±çš„ä¸€äº› View éƒ½é‡‡ç”¨äº†è¿™ç§å†™æ³•ã€‚ç„¶è€Œå¦‚æœä½ å¯¹æ­¤ä¸å‡æ€ç´¢åœ°ç…§æŠ„ä¸‹æ¥ï¼Œè¿˜æ˜¯å¯èƒ½ä¼šé‡åˆ°å‘çš„ã€‚</p><p>å…ˆæ¥çœ‹ä¸‹è¿™äº›æ„é€ æ–¹æ³•çš„ç”¨é€”ã€‚</p><ul><li>åªæœ‰ä¸€ä¸ª Context å‚æ•°çš„æ„é€ æ–¹æ³•å…¶å®ä¸»è¦æ˜¯ç»™æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»º Viewï¼ˆ<code>new View(context)</code>ï¼‰ç”¨çš„ã€‚</li><li>ç¬¬äºŒä¸ªæ„é€ æ–¹æ³•ç”¨äºä»å¸ƒå±€æ–‡ä»¶ä¸­åˆ›å»ºï¼ˆinflateï¼‰ Viewï¼Œä¼šåœ¨ inflate è¿‡ç¨‹ä¸­é€šè¿‡åå°„è¢«è°ƒç”¨åˆ°ã€‚</li><li>åé¢ä¸¤ä¸ªæ„é€ æ–¹æ³•å¹¶ä¸ä¼šç”±ç³»ç»Ÿå»è°ƒç”¨ï¼Œä¸»è¦æ˜¯ç»™å­ç±» View è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•åˆå§‹åŒ–ç”¨çš„ã€‚</li></ul><p>View çš„æ„é€ æ–¹æ³•æ˜¯ç”¨æ¥åˆå§‹åŒ– View å±æ€§ï¼ˆæ¯”å¦‚èƒŒæ™¯ï¼Œè¾¹è·ï¼Œidï¼Œæ–‡å­—å¤§å°ï¼Œæ–‡å­—é¢œè‰²ç­‰ç­‰ï¼‰çš„ï¼Œé‚£ä¹ˆè¿™äº›åˆå§‹å€¼ä»å“ªé‡Œæ¥ä»¥åŠå¦‚ä½•è·å–å°±æ˜¯æˆ‘ä»¬é¦–å…ˆè¦å…³å¿ƒçš„ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œè¿™äº›å€¼é€šå¸¸æ˜¯åœ¨å¸ƒå±€æ–‡ä»¶ï¼Œæˆ–è€… Style ä¸­æŒ‡å®šã€‚é€šè¿‡æŸ¥çœ‹ View çš„æºç æˆ‘ä»¬å¯ä»¥å‘ç°è¿™äº›å€¼çš„æŸ¥æ‰¾æ˜¯é€šè¿‡ Context çš„ <code>public final TypedArray obtainStyledAttributes(AttributeSet set, @StyleableRes int[] attrs, @AttrRes int defStyleAttr, @StyleRes int defStyleRes)</code> æ–¹æ³•å®Œæˆçš„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­çš„å‚æ•°å¯¹åº”äºä¸ View æ„é€ æ–¹æ³•ä¸­çš„å‚æ•°ã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°ã€‚</p><ul><li><p><code>AttributeSet attrs</code> æ˜¯æˆ‘ä»¬åœ¨å¸ƒå±€æ–‡ä»¶é‡Œé¢ä¸ºè¯¥ View å®šä¹‰çš„å±æ€§é›†ï¼Œæ¯”å¦‚ä¸ºä¸€ä¸ª TextView æŒ‡å®š <code>android:textSize=&quot;16sp&quot; android:textColor: &quot;#666&quot;</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä¸º View æŒ‡å®š <code>style</code> å±æ€§ï¼Œå¼•ç”¨ä¸€ä¸ª Style èµ„æºï¼Œè¿™æ ·å¦‚æœç›¸å…³å±æ€§æ²¡æœ‰åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ²¡æœ‰ç›´æ¥æŒ‡å®šçš„è¯ï¼Œå°±ä¼šå» Style ä¸­æŸ¥æ‰¾ã€‚</p></li><li><p>ä»¥ def å‘½åçš„å‚æ•°æ˜¯æŒ‡ defaultã€‚<code>int defStyleAttr</code> å…¶å®æ˜¯ä¸€ä¸ª attr èµ„æºï¼Œå®ƒå¯¹åº”äºå½“å‰ Theme ä¸­çš„ä¸€é¡¹å±æ€§ï¼Œå…¶å€¼æ˜¯å¯¹ä¸€ä¸ª Style çš„å¼•ç”¨ã€‚é‚£ä¹ˆæœ‰äº†è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœè¦æŸ¥æ‰¾çš„å±æ€§é€šè¿‡ <code>AttributeSet attrs</code> æ‰¾ä¸åˆ°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»å½“å‰ Theme ä¸­ç”± defStyleAttr å¼•ç”¨çš„ Style ä¸­æŸ¥æ‰¾ã€‚</p><p>  ä¸¾ä¸ªä¾‹å­ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"@style/Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"buttonStyle"</span>&gt;</span>@style/MyButtonStyle<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"MyButtonStyle"</span> <span class="attr">parent</span>=<span class="string">"Base.TextAppearance.AppCompat.Widget.Button"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:background"</span>&gt;</span>@android:color/transparent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:textColor"</span>&gt;</span>@android:color/black<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:textSize"</span>&gt;</span>24dp<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>  æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ Theme ä¸­å®šä¹‰ <code>buttonStyle</code> å±æ€§æ¥æ›´æ”¹ Button çš„é»˜è®¤æ ·å¼ã€‚è¿™é‡Œçš„ <code>buttonStyle</code> å°±æ˜¯ä¸€ä¸ª attr èµ„æº <code>&lt;attr name=&quot;buttonStyle&quot; format=&quot;reference&quot; /&gt;</code>ï¼Œå®ƒçš„å€¼å°±æ˜¯å¯¹æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ Style <code>MyButtonStyle</code> çš„å¼•ç”¨ã€‚è¿™æ ·ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰åœ¨å¸ƒå±€æ–‡ä»¶é‡Œç»™ Button å®šä¹‰ <code>android:textSize</code> çš„è¯ï¼Œå®ƒå°±ä¼šå» MyButtonStyle ä¸­æŸ¥æ‰¾ã€‚</p><p>  é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š defStyleAttr å‚æ•°ï¼ˆä¼  0 è¿›å»ï¼‰ï¼Œæˆ–è€…æˆ‘ä»¬çš„ Theme å¹¶æ²¡æœ‰å®šä¹‰ defStyleAttr å‘¢ï¼Ÿ é‚£å°±è¦çœ‹æœ€åä¸€ä¸ªå‚æ•°äº†ã€‚</p></li><li><p>æœ€åä¸€ä¸ªå‚æ•° <code>int defStyleRes</code> æ˜¾ç„¶æ˜¯ä¸€ä¸ª Style èµ„æºäº†ï¼Œåœ¨å‰é¢çš„åœ°æ–¹éƒ½ç›¸å…³å±æ€§éƒ½æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥ä»è¿™ä¸ªæŒ‡å®šçš„ Style ä¸­å»æŸ¥æ‰¾ç›¸å…³å±æ€§ã€‚</p></li><li><p>å½“ç„¶ï¼Œè¿˜æœ‰æœ€åä¸€ä¸ªæŸ¥æ‰¾ä½ç½®å°±æ˜¯æˆ‘ä»¬ç›´æ¥åœ¨ Theme ä¸­å®šä¹‰çš„å±æ€§äº†ã€‚</p></li></ul><p>é‚£ä¹ˆäº†è§£äº†è¿™äº›åŸºç¡€ä¹‹åï¼Œè®©æˆ‘ä»¬å†æ¥å›é¡¾ä¸‹ä¸Šæ–‡æåˆ°çš„å†™æ³•ã€‚</p><p>è€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬è¦ç»§æ‰¿çš„çˆ¶ç±» View åŒæ ·å®ç°äº†ä»¥ä¸Šå‡ ä¸ªæ„é€ æ–¹æ³•ï¼Œè€Œä¸”ç”¨åˆ°äº† <code>defStyleAttr</code> å’Œ <code>defStyleRes</code> å±æ€§ã€‚</p><p>æ¯”å¦‚ Button çš„æ„é€ æ–¹æ³•æ˜¯è¿™æ ·å†™çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>(context, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>(context, attrs, com.android.internal.R.attr.buttonStyle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>(context, attrs, defStyleAttr, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr, <span class="keyword">int</span> defStyleRes)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>(context, attrs, defStyleAttr, defStyleRes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒæŒ‡å®šäº†ä¼šä»å½“å‰ Theme ä¸­çš„ <code>buttonStyle</code> ä¸­å»æŸ¥æ‰¾é»˜è®¤æ ·å¼ï¼Œè€Œå¦‚æœæŒ‰ç…§ä¸Šæ–‡ä¸­çš„å†™æ³•ï¼Œæˆ‘ä»¬ç»§æ‰¿äº† Button ç±»åˆåˆšå¥½åœ¨æ„é€ æ–¹æ³•ä¸­å»è°ƒç”¨ this(â€¦) æ„é€ æ–¹æ³•ï¼Œæœ€åæ‰è°ƒç”¨ä¸€ä¸‹ superï¼Œé‚£ä¹ˆ Button çš„æ„é€ æ–¹æ³•æ¥æ”¶åˆ°çš„ <code>defStyleAttr</code> ä¹Ÿå°±ä¸æ˜¯ <code>com.android.internal.R.attr.buttonStyle</code>ï¼Œè€Œæ˜¯ 0ï¼Œè¿™æ ·å°±å¯¼è‡´äº†æˆ‘ä»¬çš„ Button æ— æ³•ä» Theme ä¸­è·å–é»˜è®¤æ ·å¼ã€‚è¿™ç§æƒ…å†µæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚</p><p>å…¶å®åé¢ä¸¤ä¸ªæ„é€ æ–¹æ³•è¦ä¼  <code>int defStyleAttr</code> ä¸ <code>int defStyleRes</code> è¿›å»ï¼Œä¹Ÿå°±æ„å‘³ç€ä¼šæ”¹å˜é»˜è®¤å±æ€§çš„æŸ¥æ‰¾ä½ç½®ï¼Œæ‰€ä»¥åªæœ‰æˆ‘ä»¬éœ€è¦è¦†ç›–çˆ¶ç±»çš„é»˜è®¤æ ·å¼æ—¶æ‰åº”è¯¥å»è°ƒç”¨è¿™ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œå¦åˆ™æˆ‘ä»¬æœ€å¥½è°ƒç”¨ç¬¬äºŒä¸ªæ„é€ æ–¹æ³• <code>super(context, attrs)</code>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ Android ä¸­ï¼Œè¦å®ç°è‡ªå®šä¹‰ Viewï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿å·²æœ‰çš„ View æ¥å®ç°ï¼Œå¹¶ä¸”è¦å†™å¯¹åº”çš„æ„é€ æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;View æœ‰å››ä¸ªä¸»è¦çš„æ„é€ æ–¹æ³•ï¼Œç¬¬å››ä¸ªéœ€è¦åœ¨ API 21 ä»¥ä¸Šï¼Œä¸€èˆ¬è€Œè¨€æˆ‘ä»¬éƒ½ä¼šå®ç°å‰ä¸‰ä¸ªã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;public View(Context context)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;public View(Context context, @Nullable AttributeSet attrs)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;public View(Context context, @Nullable AttributeSet attrs, int defStyleAttr)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;public View(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>No more magic - React Redux</title>
    <link href="https://wsxyeah.github.io/2017/07/15/no-more-magic-react-redux/"/>
    <id>https://wsxyeah.github.io/2017/07/15/no-more-magic-react-redux/</id>
    <published>2017-07-15T14:26:57.000Z</published>
    <updated>2017-08-13T02:26:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>Redux ä½œä¸ºä¸€ä¸ªçŠ¶æ€ç®¡ç†å·¥å…·ï¼ŒRedux åº“æœ¬èº«ä»…è´Ÿè´£çŠ¶æ€ç®¡ç†ï¼ŒèŒè´£å°±å¾ˆçº¯ç²¹ï¼Œè€Œä¸ View å±‚ç²˜åˆçš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚æœ¬æ–‡è¦è®²çš„ React Reduxï¼‰åˆ™å•ç‹¬æ‹†å‡ºæ¥ã€‚è¿™ä½¿åšå®ƒå¯ä»¥çµæ´»åœ°ä¸å¤šç§ View å±‚å®ç°ç»„åˆä½¿ç”¨ï¼Œè¿™ä¸€ç‚¹å¾ˆå€¼å¾—å­¦ä¹ ã€‚</p><p>æœ¬æ–‡å°†è§£æèƒ¶æ°´ React Redux èƒŒåçš„ magicã€‚</p><a id="more"></a><h2 id="ä½¿ç”¨-React-Redux-çš„ä¸€èˆ¬å§¿åŠ¿"><a href="#ä½¿ç”¨-React-Redux-çš„ä¸€èˆ¬å§¿åŠ¿" class="headerlink" title="ä½¿ç”¨ React Redux çš„ä¸€èˆ¬å§¿åŠ¿"></a>ä½¿ç”¨ React Redux çš„ä¸€èˆ¬å§¿åŠ¿</h2><p>Redux å®˜æ–¹æ–‡æ¡£ç»™å‡ºäº†ä½¿ç”¨ React Redux æ¥ç»™ React é›†æˆ Redux çš„ç”¨æ³•ã€‚</p><p>æ ¹æ®æ–‡æ¡£ï¼Œæ•´ä½“æ€æƒ³æ˜¯ç”±ä¸€ä¸ªé¡¶çº§çš„å®¹å™¨ç»„ä»¶æ¥æŒæœ‰å’Œç®¡ç† stateï¼Œå­ç»„ä»¶ä½œä¸ºå±•ç¤ºå‹ç»„ä»¶ï¼Œæ¥å—çˆ¶ç»„ä»¶ä¼ é€’çš„ props å¹¶ render å‡ºæ¥ã€‚å½“ç„¶ï¼Œè¿™äº› props æœ€ç»ˆæ¥æºäºå®¹å™¨ç»„ä»¶æ‰€æŒæœ‰çš„çš„å…¨å±€ stateã€‚</p><p>é¦–å…ˆçœ‹å®˜æ–¹çš„ç¤ºä¾‹ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">render(</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Provider&gt;,</span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure><p>Provider çš„è§’è‰²å°±æ˜¯ä¸Šæ–‡ä¸­çš„å®¹å™¨ç»„ä»¶ã€‚è¿™é‡Œå°† Provider ä½œä¸ºé¡¶çº§ç»„ä»¶ï¼Œå¹¶å°† store ä½œä¸º props ä¼ é€’ç»™å®ƒã€‚</p><p>å†æ¥çœ‹å¯¹å­ç»„ä»¶çš„åŒ…è£…</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> VisibleTodoList = connect(</span><br><span class="line">  mapStateToProps,</span><br><span class="line">  mapDispatchToProps</span><br><span class="line">)(TodoList)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> VisibleTodoList</span><br></pre></td></tr></table></figure><p>å¯¹å­ç»„ä»¶çš„åŒ…è£…é€šè¿‡ <code>connect</code> å‡½æ•°æ¥å®ç°ï¼Œå…ˆä¼ é€’ <code>mapStateToProps</code>ï¼Œ<code>mapDispatchToProps</code> ç»™ <code>connect</code> å¾—åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå†æŠŠå­ç»„ä»¶ä¼ è¿›å»å¾—åˆ°åŒ…è£…åçš„ç»„ä»¶ã€‚è¿™ä¸ªåŒ…è£…å‡ºæ¥çš„ç»„ä»¶å°±ä¼šåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡æŸç§é­”æ³•è°ƒç”¨ <code>mapStateToProps</code>ï¼Œ<code>mapDispatchToProps</code> å¹¶å°†ç»“æœä½œä¸º props ä¼ é€’ç»™å­ç»„ä»¶ï¼Œè¿™æ ·å­ç»„ä»¶å°±å¯ä»¥è®¿é—®å…¨å±€ stateï¼Œæˆ–è€… dispatch action äº†ã€‚</p><p>å…¶å®è¿™é‡Œ <code>connect</code> ç›¸å…³çš„éƒ¨åˆ†å°±æ˜¯é«˜é˜¶ç»„ä»¶ï¼ˆHigher Order Componentï¼‰çš„è§’è‰²ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›åŒ…è£…åçš„ç»„ä»¶ã€‚æˆ‘ä»¬é€šè¿‡ ReactDevTools å¯ä»¥æ¢æŸ¥åˆ°ç”Ÿæˆçš„ç»„ä»¶æ˜¯ç›´æ¥åŒ…åœ¨æˆ‘ä»¬åŸæ¥çš„ç»„ä»¶å¤–é¢çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå« Home çš„ç»„ä»¶ï¼Œè¿”å›çš„ç»„ä»¶æ ‘å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connect(Home)&gt;</span><br><span class="line">  &lt;Home/&gt;</span><br><span class="line">&lt;/Connect&gt;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ ¹æ® React Redux çš„ç”¨æ³•ï¼Œæˆ‘ä»¬ä¸»è¦çš„å…³æ³¨ç‚¹å°±æ˜¯ä¸¤ä¸ªï¼š<code>Provider</code> ç»„ä»¶ä¸ <code>connect</code> å‡½æ•°ã€‚</p><h2 id="Provider-ç»„ä»¶"><a href="#Provider-ç»„ä»¶" class="headerlink" title="Provider ç»„ä»¶"></a>Provider ç»„ä»¶</h2><p><code>Provider</code> ç»„ä»¶ç”± <code>createProvider</code> å‡½æ•°åˆ›å»ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Provider.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createProvider</span>(<span class="params">storeKey = <span class="string">'store'</span>, subKey</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> subscriptionKey = subKey || <span class="string">`<span class="subst">$&#123;storeKey&#125;</span>Subscription`</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Provider</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">        getChildContext() &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123; [storeKey]: <span class="keyword">this</span>[storeKey], [subscriptionKey]: <span class="literal">null</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">          <span class="keyword">super</span>(props, context)</span><br><span class="line">          <span class="keyword">this</span>[storeKey] = props.store;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        render() &#123;</span><br><span class="line">          <span class="keyword">return</span> Children.only(<span class="keyword">this</span>.props.children)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Provider.propTypes = &#123;</span><br><span class="line">        store: storeShape.isRequired,</span><br><span class="line">        children: PropTypes.element.isRequired,</span><br><span class="line">    &#125;</span><br><span class="line">    Provider.childContextTypes = &#123;</span><br><span class="line">        [storeKey]: storeShape.isRequired,</span><br><span class="line">        [subscriptionKey]: subscriptionShape,</span><br><span class="line">    &#125;</span><br><span class="line">    Provider.displayName = <span class="string">'Provider'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Provider</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> createProvider()</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™é‡Œçš„é‡ç‚¹å°±æ˜¯ <code>getChildContext</code> æ–¹æ³•ï¼Œå®ƒçš„è¿”å›å€¼åŒ…å«äº†å¯¹ store çš„å¼•ç”¨ã€‚<code>Provider</code> å°±æ˜¯é€šè¿‡ <code>getChildContext</code> æ¥å‘ç»„ä»¶æ ‘æä¾› contextï¼ˆstoreï¼‰çš„ã€‚</p><p>å…³äº contextï¼Œå®ƒçš„ä½œç”¨æ˜¯å‘ä¸‹ä¼ é€’æ•°æ®ï¼Œä¸ props ç›¸æ¯”ï¼Œcontext ä¸éœ€è¦ä¸€çº§ä¸€çº§åœ°æ‰‹åŠ¨ä¼ ä¸‹å»ï¼Œè€Œä¸‹é¢çš„<strong>ä»»ä½•ç»„ä»¶</strong>éƒ½èƒ½å¤Ÿé€šè¿‡ <code>this.context</code> ç›´æ¥è®¿é—® contextã€‚</p><p>å®˜æ–¹æ–‡æ¡£å¯¹ context æœ‰æ›´åŠ è¯¦ç»†çš„è§£é‡Šï¼ˆ<a href="https://facebook.github.io/react/docs/context.html" target="_blank">Context</a>ï¼‰ã€‚</p><h2 id="connect-å‡½æ•°"><a href="#connect-å‡½æ•°" class="headerlink" title="connect å‡½æ•°"></a>connect å‡½æ•°</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createConnect with default args builds the 'official' connect behavior. Calling it with</span></span><br><span class="line"><span class="comment">// different options opens up some testing and extensibility scenarios</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createConnect</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">  connectHOC = connectAdvanced,</span></span></span><br><span class="line"><span class="function"><span class="params">  mapStateToPropsFactories = defaultMapStateToPropsFactories,</span></span></span><br><span class="line"><span class="function"><span class="params">  mapDispatchToPropsFactories = defaultMapDispatchToPropsFactories,</span></span></span><br><span class="line"><span class="function"><span class="params">  mergePropsFactories = defaultMergePropsFactories,</span></span></span><br><span class="line"><span class="function"><span class="params">  selectorFactory = defaultSelectorFactory</span></span></span><br><span class="line"><span class="function"><span class="params">&#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œå°±æ˜¯ connect å‡½æ•°äº†</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    mapStateToProps,</span></span></span><br><span class="line"><span class="function"><span class="params">    mapDispatchToProps,</span></span></span><br><span class="line"><span class="function"><span class="params">    mergeProps,</span></span></span><br><span class="line"><span class="function"><span class="params">    &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">      pure = true,</span></span></span><br><span class="line"><span class="function"><span class="params">      areStatesEqual = strictEqual,</span></span></span><br><span class="line"><span class="function"><span class="params">      areOwnPropsEqual = shallowEqual,</span></span></span><br><span class="line"><span class="function"><span class="params">      areStatePropsEqual = shallowEqual,</span></span></span><br><span class="line"><span class="function"><span class="params">      areMergedPropsEqual = shallowEqual,</span></span></span><br><span class="line"><span class="function"><span class="params">      ...extraOptions</span></span></span><br><span class="line"><span class="function"><span class="params">    &#125; = &#123;&#125;</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> initMapStateToProps = match(mapStateToProps, mapStateToPropsFactories, <span class="string">'mapStateToProps'</span>)</span><br><span class="line">    <span class="keyword">const</span> initMapDispatchToProps = match(mapDispatchToProps, mapDispatchToPropsFactories, <span class="string">'mapDispatchToProps'</span>)</span><br><span class="line">    <span class="keyword">const</span> initMergeProps = match(mergeProps, mergePropsFactories, <span class="string">'mergeProps'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å› connectHOC è°ƒç”¨çš„ç»“æœ</span></span><br><span class="line">    <span class="keyword">return</span> connectHOC(selectorFactory, &#123;</span><br><span class="line">      <span class="comment">// used in error messages</span></span><br><span class="line">      methodName: <span class="string">'connect'</span>,</span><br><span class="line"></span><br><span class="line">       <span class="comment">// used to compute Connect's displayName from the wrapped component's displayName.</span></span><br><span class="line">      getDisplayName: <span class="function"><span class="params">name</span> =&gt;</span> <span class="string">`Connect(<span class="subst">$&#123;name&#125;</span>)`</span>,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// if mapStateToProps is falsy, the Connect component doesn't subscribe to store state changes</span></span><br><span class="line">      shouldHandleStateChanges: <span class="built_in">Boolean</span>(mapStateToProps),</span><br><span class="line"></span><br><span class="line">      <span class="comment">// passed through to selectorFactory</span></span><br><span class="line">      initMapStateToProps,</span><br><span class="line">      initMapDispatchToProps,</span><br><span class="line">      initMergeProps,</span><br><span class="line">      pure,</span><br><span class="line">      areStatesEqual,</span><br><span class="line">      areOwnPropsEqual,</span><br><span class="line">      areStatePropsEqual,</span><br><span class="line">      areMergedPropsEqual,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// any extra options args can override defaults of connect or connectAdvanced</span></span><br><span class="line">      ...extraOptions</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> createConnect()</span><br></pre></td></tr></table></figure><p><code>connect</code> é€šè¿‡ <code>createConnect()</code> åˆ›å»ºå‡ºæ¥ï¼Œ<code>connect</code> çš„æ ¸å¿ƒå®ç°åœ¨ <code>connectHOC</code>ï¼ˆå³<code>connectAdvanced</code>ï¼‰é‡Œã€‚</p><p><code>connectAdvanced</code> è¿”å›äº†å‡½æ•° <code>function wrapWithConnect(WrappedComponent)</code>ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª <code>WrappedComponent</code>å°±æ˜¯æˆ‘ä»¬è‡ªå·±çš„ç»„ä»¶ï¼Œè€Œ <code>wrapWithConnect</code> è¿”å›äº†ä¸€ä¸ª <code>Connect</code> ç»„ä»¶ï¼Œå®ƒå°±æ˜¯æœ€ç»ˆåŒ…è£…å¾—åˆ°çš„ç»„ä»¶ã€‚</p><p>åœ¨ Redux ä¸­ï¼Œæˆ‘ä»¬è¦æ‹¿åˆ° store çš„ stateï¼Œå°±åº”è¯¥å…ˆå» subscribe è¿™ä¸ª storeï¼Œç„¶ååœ¨ state æ›´æ–°ä¹‹åå¾—åˆ°é€šçŸ¥ã€‚æˆ‘ä»¬çš„ç»„ä»¶è¦æƒ³åœ¨ state æ›´æ–°æ—¶å¾—åˆ°é€šçŸ¥ï¼Œå°±å¾—é  <code>Connect</code> å…ˆè®¢é˜… storeï¼Œç„¶åä¼  props è¿‡æ¥ã€‚æ‰€ä»¥è¿™ä¸ª <code>Connect</code> çš„å®ç°ä¹Ÿæ˜¯å…«ä¹ä¸ç¦»åäº†ï¼Œå®ƒåº”è¯¥æ˜¯å…ˆè®¢é˜…äº† storeï¼Œåœ¨ state æ›´æ–°åå†è°ƒç”¨ <code>mapStateToProps</code> å’Œ <code>mapDispatchToProps</code>ï¼Œç»„åˆä¹‹åä½œä¸º props ä¼ ç»™å­ç»„ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">addExtraProps(props) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!withRef &amp;&amp; !renderCountProp &amp;&amp; !(<span class="keyword">this</span>.propsMode &amp;&amp; <span class="keyword">this</span>.subscription)) <span class="keyword">return</span> props</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> withExtras = &#123; ...props &#125;</span><br><span class="line">  <span class="keyword">if</span> (withRef) withExtras.ref = <span class="keyword">this</span>.setWrappedInstance</span><br><span class="line">  <span class="keyword">if</span> (renderCountProp) withExtras[renderCountProp] = <span class="keyword">this</span>.renderCount++</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.propsMode &amp;&amp; <span class="keyword">this</span>.subscription) withExtras[subscriptionKey] = <span class="keyword">this</span>.subscription</span><br><span class="line">  <span class="keyword">return</span> withExtras</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> selector = <span class="keyword">this</span>.selector</span><br><span class="line">  selector.shouldComponentUpdate = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (selector.error) &#123;</span><br><span class="line">    <span class="keyword">throw</span> selector.error</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ç»™å­ç»„ä»¶åŠ äº† selector.props å±æ€§ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä¹Ÿå°±æ˜¯ mapStateToProps, mapDispatchToProps è¿”å›çš„ä¸œè¥¿</span></span><br><span class="line">    <span class="keyword">return</span> createElement(WrappedComponent, <span class="keyword">this</span>.addExtraProps(selector.props))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeSelectorStateful</span>(<span class="params">sourceSelector, store</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// wrap the selector in an object that tracks its results between runs.</span></span><br><span class="line">  <span class="keyword">const</span> selector = &#123;</span><br><span class="line">    run: <span class="function"><span class="keyword">function</span> <span class="title">runComponentSelector</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> nextProps = sourceSelector(store.getState(), props)</span><br><span class="line">        <span class="keyword">if</span> (nextProps !== selector.props || selector.error) &#123;</span><br><span class="line">          selector.shouldComponentUpdate = <span class="literal">true</span></span><br><span class="line">          selector.props = nextProps</span><br><span class="line">          selector.error = <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        selector.shouldComponentUpdate = <span class="literal">true</span></span><br><span class="line">        selector.error = error</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> selector</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Connect</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props, context)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.state = &#123;&#125;</span><br><span class="line">    <span class="keyword">this</span>.renderCount = <span class="number">0</span></span><br><span class="line">    <span class="comment">// ä» props æˆ– context é‡Œå–å‡º store</span></span><br><span class="line">    <span class="keyword">this</span>.store = props[storeKey] || context[storeKey]</span><br><span class="line">    <span class="keyword">this</span>.propsMode = <span class="built_in">Boolean</span>(props[storeKey])</span><br><span class="line">    <span class="keyword">this</span>.setWrappedInstance = <span class="keyword">this</span>.setWrappedInstance.bind(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– this.selector</span></span><br><span class="line">    <span class="keyword">this</span>.initSelector()</span><br><span class="line">    <span class="comment">// è®¢é˜… store</span></span><br><span class="line">    <span class="keyword">this</span>.initSubscription()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  initSelector() &#123;</span><br><span class="line">    <span class="keyword">const</span> sourceSelector = selectorFactory(<span class="keyword">this</span>.store.dispatch, selectorFactoryOptions)</span><br><span class="line">    <span class="comment">// æ–¹æ³•å®šä¹‰è§ä¸Šé¢</span></span><br><span class="line">    <span class="comment">// è¿”å›çš„å¯¹è±¡ selector å¯¹è±¡åŒ…å«ä¸€ä¸ª run æ–¹æ³•ï¼Œ</span></span><br><span class="line">    <span class="comment">// run æ–¹æ³•ä¼šè°ƒç”¨ selector å‡½æ•°è®¡ç®—å‡ºæ–°çš„ propsï¼Œå¹¶æŠŠ props ä½œä¸ºå±æ€§æš´éœ²å‡ºæ¥ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä¹Ÿå°±æ˜¯ render æ–¹æ³•ä¸­æ‰€è¯»å–çš„ selector.props</span></span><br><span class="line">    <span class="keyword">this</span>.selector = makeSelectorStateful(sourceSelector, <span class="keyword">this</span>.store)</span><br><span class="line">    <span class="keyword">this</span>.selector.run(<span class="keyword">this</span>.props)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  initSubscription() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!shouldHandleStateChanges) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> parentSub = (<span class="keyword">this</span>.propsMode ? <span class="keyword">this</span>.props : <span class="keyword">this</span>.context)[subscriptionKey]</span><br><span class="line">    <span class="comment">// Subscription æ˜¯ç”¨æ¥ç®¡ç†è®¢é˜…çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œè¿™é‡Œçš„ onStateChange å‡½æ•°ä¼šæ¥æ”¶ state æ›´æ–°</span></span><br><span class="line">    <span class="keyword">this</span>.subscription = <span class="keyword">new</span> Subscription(<span class="keyword">this</span>.store, parentSub, <span class="keyword">this</span>.onStateChange.bind(<span class="keyword">this</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.notifyNestedSubs = <span class="keyword">this</span>.subscription.notifyNestedSubs.bind(<span class="keyword">this</span>.subscription)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!shouldHandleStateChanges) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.subscription.trySubscribe()</span><br><span class="line">    <span class="keyword">this</span>.selector.run(<span class="keyword">this</span>.props)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.selector.shouldComponentUpdate) <span class="keyword">this</span>.forceUpdate()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">    <span class="keyword">this</span>.selector.run(nextProps)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  shouldComponentUpdate() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.selector.shouldComponentUpdate</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.subscription) <span class="keyword">this</span>.subscription.tryUnsubscribe()</span><br><span class="line">    <span class="keyword">this</span>.subscription = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">this</span>.notifyNestedSubs = noop</span><br><span class="line">    <span class="keyword">this</span>.store = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">this</span>.selector.run = noop</span><br><span class="line">    <span class="keyword">this</span>.selector.shouldComponentUpdate = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// state æœ‰æ›´æ–°</span></span><br><span class="line">  onStateChange() &#123;</span><br><span class="line">    <span class="comment">// è®¡ç®— selector.props</span></span><br><span class="line">    <span class="keyword">this</span>.selector.run(<span class="keyword">this</span>.props)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.selector.shouldComponentUpdate) &#123;</span><br><span class="line">      <span class="keyword">this</span>.notifyNestedSubs()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.componentDidUpdate = <span class="keyword">this</span>.notifyNestedSubsOnComponentDidUpdate</span><br><span class="line">      <span class="comment">// è°ƒç”¨ setState è§¦å‘ render</span></span><br><span class="line">      <span class="keyword">this</span>.setState(dummyState)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  notifyNestedSubsOnComponentDidUpdate() &#123;</span><br><span class="line">    <span class="keyword">this</span>.componentDidUpdate = <span class="literal">undefined</span></span><br><span class="line">    <span class="keyword">this</span>.notifyNestedSubs()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>Connect</code> è®¢é˜…äº† storeï¼Œå¹¶åœ¨ <code>onStateChange</code> ä¸­ä»¤ selector é‡æ–°è®¡ç®— propsï¼Œä¹‹å setState è§¦å‘ç»„ä»¶çš„ renderï¼Œä½¿å­ç»„ä»¶çš„ props å¾—åˆ°æ›´æ–°ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://redux.js.org/docs/basics/UsageWithReact.html" target="_blank">Redux Usage with React</a></li><li></li><li><a href="https://facebook.github.io/react/docs/context.html" target="_blank">React Context</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Redux ä½œä¸ºä¸€ä¸ªçŠ¶æ€ç®¡ç†å·¥å…·ï¼ŒRedux åº“æœ¬èº«ä»…è´Ÿè´£çŠ¶æ€ç®¡ç†ï¼ŒèŒè´£å°±å¾ˆçº¯ç²¹ï¼Œè€Œä¸ View å±‚ç²˜åˆçš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚æœ¬æ–‡è¦è®²çš„ React Reduxï¼‰åˆ™å•ç‹¬æ‹†å‡ºæ¥ã€‚è¿™ä½¿åšå®ƒå¯ä»¥çµæ´»åœ°ä¸å¤šç§ View å±‚å®ç°ç»„åˆä½¿ç”¨ï¼Œè¿™ä¸€ç‚¹å¾ˆå€¼å¾—å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†è§£æèƒ¶æ°´ React Redux èƒŒåçš„ magicã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ç”¨ Word å†™è®ºæ–‡çš„ä¸€ç‚¹å„¿ç»éªŒ</title>
    <link href="https://wsxyeah.github.io/2017/05/20/Microsoft-Word-Skills/"/>
    <id>https://wsxyeah.github.io/2017/05/20/Microsoft-Word-Skills/</id>
    <published>2017-05-20T00:32:37.000Z</published>
    <updated>2017-07-15T01:20:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ°´ä¸€ç¯‡~</p><a id="more"></a><h2 id="1-å–„ç”¨-Style"><a href="#1-å–„ç”¨-Style" class="headerlink" title="1. å–„ç”¨ Style"></a>1. å–„ç”¨ Style</h2><p>å†™ä¸ªè®ºæ–‡æ ¼å¼ä»€ä¹ˆçš„è¦æ±‚è¿˜æ˜¯æŒºå¤šçš„ï¼Œæ ‡é¢˜ï¼æ­£æ–‡ç”¨ä»€ä¹ˆå­—ä½“ï¼Œå­—å·éƒ½æœ‰è§„å®šã€‚è¦æ–¹ä¾¿è®¾ç½®æ ¼å¼å°±è¦å–„ç”¨ Styleã€‚</p><p>é¦–å…ˆæ˜¯é€‰æ‹©ä¸€å¥—ä¸ä½ çš„éœ€æ±‚æ¯”è¾ƒæ¥è¿‘çš„åŸºæœ¬ä¸»é¢˜ï¼Œå¯ä»¥å°½é‡é™ä½è‡ªå®šä¹‰æ ·å¼çš„å·¥ä½œé‡ã€‚</p><p>ç„¶åä½ å°±å¯ä»¥æŒ‰è®ºæ–‡è¦æ±‚è‡ªå®šä¹‰ Style äº†ã€‚æ‰“å¼€ Styles Paneï¼Œå°±å¯ä»¥çœ‹åˆ°é¢„å®šä¹‰çš„å„ç§æ ·å¼ï¼Œå¯ä»¥ç›´æ¥å°†å…¶åº”ç”¨åˆ°æ–‡ä¸­ã€‚é’ˆå¯¹æŸä¸€ä¸ªæ ·å¼ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œä¿®æ”¹ï¼Œåº”ç”¨è¯¥æ ·å¼çš„æ–‡æœ¬éƒ½å¯ä»¥éšä¹‹æ›´æ–°ï¼Œæ˜¯ä¸æ˜¯å¾ˆåƒå†™ CSSï¼Ÿæ ·å¼è¿˜å¯ä»¥ç»§æ‰¿å·²æœ‰æ ·å¼ï¼Œé¢‡æœ‰ç‚¹ OO çš„æ„Ÿè§‰ã€‚</p><h2 id="2-å‚è€ƒæ–‡çŒ®çš„-tricks"><a href="#2-å‚è€ƒæ–‡çŒ®çš„-tricks" class="headerlink" title="2. å‚è€ƒæ–‡çŒ®çš„ tricks"></a>2. å‚è€ƒæ–‡çŒ®çš„ tricks</h2><p>ä¸€ç¯‡å°è®ºæ–‡è¿˜ç”¨ä¸ç€ Citation è¿™ä¹ˆé«˜çº§çš„åŠŸèƒ½ï¼Œè€Œä¸”æˆ‘å¤§æ¸…è‡ªæœ‰å›½æƒ…åœ¨æ­¤ï¼ŒWord çš„è¿™ä¸ªåŠŸèƒ½ä¹Ÿä¸å¤Ÿæœ¬åœŸåŒ–ã€‚è¦æ·»åŠ å‚è€ƒæ–‡çŒ®ï¼Œåªéœ€è¦ç”¨ Cross-reference å°±å¯ä»¥äº†ã€‚é¦–å…ˆåœ¨çŸ¥ç½‘æˆ–å…¶ä»–åœ°æ–¹å¯¼å‡ºå‚è€ƒæ–‡çŒ®æ ¼å¼ï¼Œå¤åˆ¶åˆ°æ–‡ä¸­ï¼Œç„¶åä½¿ç”¨ Word ç»™å®ƒä»¬æ·»åŠ ç¼–å·ï¼Œå†åœ¨åŸæ–‡å¼•ç”¨çš„åœ°æ–¹æ’å…¥ Cross-reference æ—¶ç›´æ¥é€‰æ‹©å¯¹åº”çš„å‚è€ƒæ–‡çŒ®æ¡ç›®å°±å¥½äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ°´ä¸€ç¯‡~&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Marshmallow Runtime Permissions</title>
    <link href="https://wsxyeah.github.io/2017/04/05/Marshmallow-Runtime-Permissions/"/>
    <id>https://wsxyeah.github.io/2017/04/05/Marshmallow-Runtime-Permissions/</id>
    <published>2017-04-05T02:06:33.000Z</published>
    <updated>2017-04-05T03:38:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä» Android 6.0 ï¼ˆAPI 23ï¼‰ å¼€å§‹ç³»ç»Ÿå¼€å§‹å°†åº”ç”¨æƒé™æ”¶ç´§ï¼Œå°†æƒé™åˆ†ä¸ºæ™®é€šï¼ˆNormal Permissionsï¼‰æƒé™ä¸å±é™©æƒé™ï¼ˆDangerous Permissionsï¼‰ã€‚</p><p>æ™®é€šæƒé™ä¸ä¼šå½±å“åˆ°ç”¨æˆ·çš„éšç§ï¼Œåªè¦åƒä»¥å¾€é‚£æ ·åœ¨ manifest ä¸­å£°æ˜å³å¯ä½¿ç”¨ã€‚<br>å±é™©æƒé™ä¸ä»…è¦åœ¨ manifest ä¸­å£°æ˜ï¼Œè€Œä¸”éœ€è¦è·å¾—ç”¨æˆ·çš„æ‰¹å‡†ã€‚è™½ç„¶å¯ä»¥ä¸´æ—¶å°† target API è®¾ç½®åœ¨ 23 ä»¥ä¸‹è§„é¿ï¼Œä½†ä¸€æ¥ç”¨æˆ·ä»ç„¶å¯ä»¥åœ¨ç³»ç»Ÿè®¾ç½®ä¸­å¼ºåˆ¶æ‹’ç»æˆäºˆæƒé™é€ æˆåº”ç”¨å´©æºƒï¼ŒäºŒæ¥ä¹Ÿå¹¶éé•¿ä¹…ä¹‹è®¡ã€‚</p><a id="more"></a><h1 id="å±é™©æƒé™åŠåˆ†ç»„"><a href="#å±é™©æƒé™åŠåˆ†ç»„" class="headerlink" title="å±é™©æƒé™åŠåˆ†ç»„"></a>å±é™©æƒé™åŠåˆ†ç»„</h1><p>ç³»ç»Ÿåˆ†ç»„å¤„ç†å±é™©æƒé™çš„æˆäºˆï¼Œå¦‚æœåº”ç”¨å·²ç»è·å¾—æŸä¸ªç»„å†…çš„æŸé¡¹æƒé™ï¼Œé‚£ä¹ˆä¹Ÿå°±é»˜è®¤è·å¾—äº†è¯¥ç»„å†…çš„å…¶ä»–æƒé™ã€‚æ¯”å¦‚æˆ‘ä»¬å·²ç»è·å¾—äº† <code>READ_CONTACTS</code> æƒé™ï¼Œé‚£ä¹ˆç›¸å½“äº <code>CONTACTS</code> ç»„å†…çš„ <code>WRITE_CONTACTS</code> å’Œ <code>GET_ACCOUNTS</code> æƒé™ä¹Ÿè·å¾—äº†ã€‚</p><table><thead><tr><th>Permission Group</th><th>Permissions</th></tr></thead><tbody><tr><td>CALENDAR</td><td><div>READ_CALENDAR</div><div>WRITE_CALENDAR</div></td></tr><tr><td>CAMERA</td><td>CAMERA</td></tr><tr><td>CONTACTS</td><td><div>READ_CONTACTS</div><div>WRITE_CONTACTS</div><div>GET_ACCOUNTS</div></td></tr><tr><td>LOCATION</td><td><div>ACCESS_FINE_LOCATION</div><div>ACCESS_COARSE_LOCATION</div></td></tr><tr><td>MICROPHONE</td><td>RECORD_AUDIO</td></tr><tr><td>PHONE</td><td><div>READ_PHONE_STATE</div><div>CALL_PHONE</div><div>READ_CALL_LOG</div><div>WRITE_CALL_LOG</div><div>ADD_VOICEMAIL</div><div>USE_SIP</div><div>PROCESS_OUTGOING_CALLS</div></td></tr><tr><td>SENSORS</td><td>BODY_SENSORS</td></tr><tr><td>SMS</td><td><div>SEND_SMS</div><div>RECEIVE_SMS</div><div>READ_SMS</div><div>RECEIVE_WAP_PUSH</div><div>RECEIVE_MMS</div></td></tr><tr><td>STORAGE</td><td><div>READ_EXTERNAL_STORAGE</div><div>WRITE_EXTERNAL_STORAGE</div></td></tr></tbody></table><h1 id="åŸºæœ¬-API-ä½¿ç”¨"><a href="#åŸºæœ¬-API-ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ API ä½¿ç”¨"></a>åŸºæœ¬ API ä½¿ç”¨</h1><p>ä¸è¿è¡Œæ—¶æƒé™ç›¸å…³çš„ API ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Context/ContextCompat</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkSelfPermission</span> <span class="params">(String permission)</span></span></span><br><span class="line"><span class="function"><span class="comment">// Activity/ActivityCompat</span></span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">shouldShowRequestPermissionRationale</span> <span class="params">(String permission)</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">requestPermissions</span> <span class="params">(String[] permissions, <span class="keyword">int</span> requestCode)</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span> <span class="params">(<span class="keyword">int</span> requestCode, String[] permissions, <span class="keyword">int</span>[] grantResults)</span></span></span><br></pre></td></tr></table></figure><p><code>checkSelfPermission</code> æ–¹æ³•ç”¨æ¥æ£€æµ‹æ˜¯å¦å·²ç»è·å¾—æŸé¡¹æƒé™ï¼Œè¿”å›ç»“æœä¸º<code>PackageManager.PERMISSION_GRANTED</code> æˆ– <code>PackageManager.PERMISSION_DENIED</code> ã€‚</p><p><code>shouldShowRequestPermissionRationale</code> è¡¨ç¤ºåº”ç”¨æ˜¯å¦åº”è¯¥å‘ç”¨æˆ·è§£é‡Šä¸ºä½•éœ€è¦æƒé™ã€‚æœªè¯·æ±‚è¿‡è¯¥æƒé™æ—¶è¿”å› falseã€‚</p><p><code>requestPermissions</code> æ‰§è¡Œè¯·æ±‚æƒé™çš„å®é™…æ“ä½œï¼Œåœ¨è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œç³»ç»Ÿå¼¹å‡ºå¯¹è¯æ¡†è®©ç”¨æˆ·é€‰æ‹©æ˜¯å¦å…è®¸è·å–æ‰€è¯·æ±‚çš„æƒé™ã€‚<br>å¦‚æœç”¨æˆ·é€‰æ‹©äº† Never ask again å¹¶æ‹’ç»æˆäºˆï¼Œé‚£ä¹ˆä¹‹åè°ƒç”¨ <code>requestPermissions</code> è¯·æ±‚è¯¥æƒé™ç›´æ¥ä¼šè¢«æ‹’ç»ï¼Œ<code>shouldShowRequestPermissionRationale</code> éƒ½ä¼šè¿”å› falseã€‚</p><p><code>onRequestPermissionsResult</code> æ–¹æ³•æ˜¯ Activity çš„ä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼Œç±»ä¼¼äº <code>onActivityResult</code>ï¼Œè¿”å›æƒé™è¯·æ±‚çš„ç»“æœã€‚</p><h1 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    <span class="comment">// æœªè·å¾—è¯¥æƒé™</span></span><br><span class="line">    <span class="keyword">if</span> (ActivityCompat.shouldShowRequestPermissionRationale(<span class="keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE)) &#123;</span><br><span class="line">        <span class="comment">// è¢«æ‹’ç»è¿‡ï¼Œå‘ç”¨æˆ·è§£é‡Šä¸ºä½•éœ€è¦è¯¥æƒé™åå†è¯·æ±‚</span></span><br><span class="line">        showPermissionExplanation();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä¹‹å‰ä»æœªè¯·æ±‚è¿‡è¯¥æƒé™æˆ–è¢«æ°¸ä¹…æ‹’ç»ï¼Œç›´æ¥å‘èµ·è¯·æ±‚</span></span><br><span class="line">        ActivityCompat.requestPermissions(<span class="keyword">this</span>,</span><br><span class="line">                <span class="keyword">new</span> String[]&#123;Manifest.permission.WRITE_EXTERNAL_STORAGE&#125;,</span><br><span class="line">                PERMISSION_REQUEST_STORAGE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span><span class="params">(<span class="keyword">int</span> requestCode, @NonNull String[] permissions, @NonNull <span class="keyword">int</span>[] grantResults)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">    <span class="keyword">if</span> (requestCode == PERMISSION_REQUEST_STORAGE) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; permissions.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (Manifest.permission.WRITE_EXTERNAL_STORAGE.equals(permissions[i])) &#123;</span><br><span class="line">                <span class="keyword">if</span> (PackageManager.PERMISSION_GRANTED == grantResults[i]) &#123;</span><br><span class="line">                    <span class="comment">// æˆåŠŸè·å¾—æƒé™</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// è¢«æ‹’ç»</span></span><br><span class="line">                    <span class="comment">// å¦‚æœè¯¥æƒé™å¿…é¡»çš„è¯ï¼Œå¯ä»¥æ£€æŸ¥ shouldShowRequestPermissionRationale</span></span><br><span class="line">                    <span class="comment">// è‹¥è¿”å› trueï¼Œè¡¨ç¤ºç”¨æˆ·æ°¸ä¹…æ‹’ç»ï¼Œå¯ä»¥å¼•å¯¼ç”¨æˆ·åœ¨ç³»ç»Ÿè®¾ç½®ä¸­é‡æ–°æˆäºˆæƒé™</span></span><br><span class="line">                    <span class="keyword">if</span> (!ActivityCompat.shouldShowRequestPermissionRationale(<span class="keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE)) &#123;</span><br><span class="line">                        showPermissionGuide();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://developer.android.com/training/permissions/requesting.html" target="_blank">Requesting Permissions at Run Time</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä» Android 6.0 ï¼ˆAPI 23ï¼‰ å¼€å§‹ç³»ç»Ÿå¼€å§‹å°†åº”ç”¨æƒé™æ”¶ç´§ï¼Œå°†æƒé™åˆ†ä¸ºæ™®é€šï¼ˆNormal Permissionsï¼‰æƒé™ä¸å±é™©æƒé™ï¼ˆDangerous Permissionsï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ™®é€šæƒé™ä¸ä¼šå½±å“åˆ°ç”¨æˆ·çš„éšç§ï¼Œåªè¦åƒä»¥å¾€é‚£æ ·åœ¨ manifest ä¸­å£°æ˜å³å¯ä½¿ç”¨ã€‚&lt;br&gt;å±é™©æƒé™ä¸ä»…è¦åœ¨ manifest ä¸­å£°æ˜ï¼Œè€Œä¸”éœ€è¦è·å¾—ç”¨æˆ·çš„æ‰¹å‡†ã€‚è™½ç„¶å¯ä»¥ä¸´æ—¶å°† target API è®¾ç½®åœ¨ 23 ä»¥ä¸‹è§„é¿ï¼Œä½†ä¸€æ¥ç”¨æˆ·ä»ç„¶å¯ä»¥åœ¨ç³»ç»Ÿè®¾ç½®ä¸­å¼ºåˆ¶æ‹’ç»æˆäºˆæƒé™é€ æˆåº”ç”¨å´©æºƒï¼ŒäºŒæ¥ä¹Ÿå¹¶éé•¿ä¹…ä¹‹è®¡ã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Gradle for Android ç¬”è®°</title>
    <link href="https://wsxyeah.github.io/2017/01/18/gradle-for-android/"/>
    <id>https://wsxyeah.github.io/2017/01/18/gradle-for-android/</id>
    <published>2017-01-18T08:03:36.000Z</published>
    <updated>2017-01-18T08:08:43.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h1><ul><li>DSL</li><li>based on Groovy</li><li><code>{}</code>ï¼šé—­åŒ…</li></ul><a id="more"></a><h1 id="Gradle-for-Android"><a href="#Gradle-for-Android" class="headerlink" title="Gradle for Android"></a>Gradle for Android</h1><ul><li>ç”¨ V è¡¨ç¤ºé›†åˆ Build Variantsï¼ŒT è¡¨ç¤ºé›†åˆ Build Typesï¼ŒF è¡¨ç¤ºé›†åˆ Product Flavorsï¼Œåˆ™ V = T Ã— Fã€‚</li><li>e.g.</li></ul><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/build.gradle</span></span><br><span class="line">apply plugin: <span class="string">'com.android.application'</span></span><br><span class="line"></span><br><span class="line">android &#123; <span class="comment">// å½“æˆ‘ä»¬åœ¨å†™ä¸€ä¸ªä¸€ä¸ªçš„ `&#123;&#125;` æ—¶ï¼Œå…¶å®å°±æ˜¯åœ¨è°ƒç”¨å‡½æ•°ï¼Œå¹¶ä¼ ä¸€ä¸ªé—­åŒ…è¿›å»</span></span><br><span class="line">    compileSdkVersion <span class="number">25</span></span><br><span class="line">    buildToolsVersion <span class="string">"23.0.2"</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">"me.sxwang.explore"</span></span><br><span class="line">        minSdkVersion <span class="number">15</span></span><br><span class="line">        targetSdkVersion <span class="number">25</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">"1.0"</span></span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></span><br><span class="line">            manifestPlaceholders = [CHANNEL: <span class="string">"official"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„ productFlavors å¯¹åº”</span></span><br><span class="line">    <span class="comment">// void productFlavors(Action&lt;? super NamedDomainObjectContainer&lt;ProductFlavor&gt;&gt; action)</span></span><br><span class="line">    <span class="comment">// æ–¹æ³•ï¼Œæ‰§è¡Œè¯¥æ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨ action.execute(produtFlavors)ã€‚</span></span><br><span class="line">    <span class="comment">// productFlavors çš„å®é™…ç±»å‹ä¸º NamedDomainObjectContainer&lt;ProductFlavor&gt;ï¼Œ</span></span><br><span class="line">    <span class="comment">// NamedDomainObjectContainer æ˜¯ Gradle ä¸­å®šä¹‰çš„ä¸€ä¸ªæ¥å£</span></span><br><span class="line">    <span class="comment">// ï¼ˆhttps://docs.gradle.org/current/dsl/org.gradle.api.NamedDomainObjectContainer.htmlï¼‰ï¼Œ</span></span><br><span class="line">    <span class="comment">// é—­åŒ…å†…çš„ä»£ç é€šè¿‡ create(name, configureClosure) ï¼getByName(name, configureClosure) </span></span><br><span class="line">    <span class="comment">// æ–¹æ³•å®ç°äº†å¯¹ productFlavors çš„é…ç½®</span></span><br><span class="line">    productFlavors &#123;</span><br><span class="line">        wandoujia &#123;</span><br><span class="line">            manifestPlaceholders = [CHANNEL: <span class="string">"wandoujia"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        xiaomi &#123;</span><br><span class="line">            manifestPlaceholders = [CHANNEL: <span class="string">"xiaomi"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„ productFlavors å¯¹åº”è°ƒç”¨ getProductFlavors() æ–¹æ³•ï¼Œè¿”å›ç±»å‹ä¸º Collection&lt;ProductFlavor&gt;ï¼Œ</span></span><br><span class="line">    <span class="comment">// Collection æ˜¯ Groovy JDK æä¾›çš„ç±»ï¼ˆhttp://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Collection.htmlï¼‰</span></span><br><span class="line">    <span class="comment">// each() æ–¹æ³•éå†é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œåœ¨ Collection ä¸­å®šä¹‰</span></span><br><span class="line">    <span class="comment">// å¯è§è¿™é‡Œä½¿ç”¨ each() ä»…å¯¹å‰é¢å·²ç»åˆ›å»ºçš„ product flavors ç”Ÿæ•ˆ</span></span><br><span class="line">    productFlavors.<span class="keyword">each</span> &#123; flavor -&gt;</span><br><span class="line">        <span class="keyword">println</span>(<span class="string">"====&gt; Configuring productFlavor: $&#123;flavor.name&#125;"</span>)</span><br><span class="line">        flavor.manifestPlaceholders = [CHANNEL: flavor.name]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// applicationVariants ä¸º DomainObjectSet&lt;ApplicationVariant&gt; ç±»å‹ï¼Œ</span></span><br><span class="line">    <span class="comment">// è™½ç„¶ä¹Ÿæ˜¯ Collection ç±»å‹ï¼Œä½†æ˜¯æ­¤æ—¶å…¶é›†åˆå…ƒç´ ä¸ºç©ºï¼Œæ•…ä½¿ç”¨ each() æ— æ•ˆã€‚</span></span><br><span class="line">    <span class="comment">// å½“ç„¶ DomainObjectSet ä¹Ÿå®ç°äº†å¦ä¸€ä¸ªæ¥å£ DomainObjectCollectionï¼Œæ¥å£ä¸­å®šä¹‰çš„</span></span><br><span class="line">    <span class="comment">// all() æ–¹æ³•ä¿è¯å¯¹äºåç»­æ·»åŠ çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šç”Ÿæ•ˆ</span></span><br><span class="line">    applicationVariants.all &#123; variant -&gt;</span><br><span class="line">        <span class="keyword">println</span>(<span class="string">"====&gt; Configuring variant: $&#123;variant.name&#125;"</span>)</span><br><span class="line">        variant.assemble.dependsOn.<span class="keyword">each</span> &#123; dependency -&gt;</span><br><span class="line">            <span class="keyword">println</span>(dependency)</span><br><span class="line">        &#125;</span><br><span class="line">        variant.outputs.<span class="keyword">each</span> &#123; output -&gt;</span><br><span class="line">            output.outputFile = <span class="keyword">new</span> <span class="keyword">File</span>(output.outputFile.parent, <span class="string">"x-$&#123;variant.name&#125;.apk"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        variant.assemble.<span class="keyword">doFirst</span> &#123;</span><br><span class="line">            <span class="keyword">println</span>(<span class="string">"====&gt; doFirst: $&#123;variant.name&#125;"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="keyword">compile</span> <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:25.1.0'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:design:25.1.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><p><a target="_blank" href="http://docs.groovy-lang.org/latest/html/groovy-jdk/">Groovy JDK API Documentation</a></p></li><li><p><a target="_blank" href="https://docs.gradle.org/current/dsl/">Gradle Build Language Reference</a></p></li><li><p><a target="_blank" href="https://docs.gradle.org/current/userguide/userguide.html">Gradle User Guide</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Gradle&quot;&gt;&lt;a href=&quot;#Gradle&quot; class=&quot;headerlink&quot; title=&quot;Gradle&quot;&gt;&lt;/a&gt;Gradle&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;DSL&lt;/li&gt;
&lt;li&gt;based on Groovy&lt;/li&gt;
&lt;li&gt;&lt;code&gt;{}&lt;/code&gt;ï¼šé—­åŒ…&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Java çš„åŒ…è£…ç±»å‹ï¼Œè‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</title>
    <link href="https://wsxyeah.github.io/2016/11/01/java-wrapper-classes/"/>
    <id>https://wsxyeah.github.io/2016/11/01/java-wrapper-classes/</id>
    <published>2016-11-01T13:46:43.000Z</published>
    <updated>2016-11-02T00:22:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>Java ä½œä¸ºä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä»ç„¶ä¿ç•™äº†åŸºæœ¬çš„å‡ ç§å€¼ç±»å‹ï¼ˆintï¼Œshortï¼Œlongï¼Œbyteï¼Œcharï¼Œbooleanï¼Œfloatï¼Œdoubleï¼‰ã€‚å½“ç„¶ä¸ºäº†æ–¹ä¾¿å¼€å‘äººå‘˜ä½¿ç”¨ä¹Ÿæä¾›äº†å¯¹åº”çš„åŒ…è£…ç±»ï¼Œï¼ˆIntegerï¼ŒShortï¼ŒLongï¼ŒByteï¼ŒCharï¼ŒBooleanï¼ŒFloatï¼ŒDoubleï¼‰ï¼Œå¹¶ä¸”åœ¨ Java 1.5 ä¸­å¼€å§‹æä¾›äº†è‡ªåŠ¨è£…ç®±ï¼ˆboxingï¼‰å’Œæ‹†ç®±ï¼ˆunboxingï¼‰ç‰¹æ€§ã€‚</p><p>è‡ªåŠ¨è£…ç®±çš„ä¸»è¦ä½œç”¨æ˜¯æ–¹ä¾¿åœ¨å€¼ç±»å‹å’ŒåŒ…è£…ç±»å‹ä¹‹é—´åˆ‡æ¢ï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥åœ¨æºä»£ç é‡Œå°†å€¼ç±»å‹èµ‹å€¼ç»™åŒ…è£…ç±»å‹æˆ–åä¹‹ï¼Œä½¿ç”¨ == æ¥æ¯”è¾ƒå€¼ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„å€¼ã€‚è¿™é‡Œæåˆ°æ˜¯æºä»£ç é‡Œè¿™æ ·åšæ˜¯å› ä¸ºè‡ªåŠ¨è£…ç®±ï¼æ‹†ç®±ç‰¹æ€§ä¸»è¦ç”±ç¼–è¯‘å™¨å¸®æˆ‘ä»¬å®Œæˆã€‚<br><a id="more"></a></p><p>å½“æˆ‘ä»¬ç¼–å†™ä»¥ä¸‹ä¸€æ®µç¨‹åºæ—¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="keyword">new</span> Integer(<span class="number">5</span>);</span><br><span class="line">Integer b = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">assert</span>(a == b);</span><br></pre></td></tr></table></figure><ul><li>å…¶ä¸­ç¬¬ä¸€è¡Œä»£ç éœ€è¦å°†åŒ…è£…ç±»å‹èµ‹å€¼ç»™å€¼ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆç­‰æ•ˆäº <code>int a = new Integer(5).intValue();</code> çš„ä»£ç </li><li>å¯¹äºç¬¬äºŒè¡Œï¼Œåˆ™æœ‰ <code>Integer b = Integer.valueOf(6);</code></li><li>è€Œå¯¹äºå€¼ç±»å‹ä¸åŒ…è£…ç±»å‹çš„æ¯”è¾ƒï¼Œåˆ™ä¼šå…ˆå°†åŒ…è£…ç±»å‹è½¬ä¸ºåŸºæœ¬ç±»å‹ï¼Œå³ <code>assert(a.intValue() == b);</code></li></ul><p>å…³äºåŒ…è£…ç±»å‹çš„ç¼“å­˜<br>æ ¹æ® Java è¯­è¨€è§„èŒƒï¼ˆJLS8ï¼ŒÂ§5.1.7ï¼‰ï¼ŒåŒ…è£…ç±»å‹ä¼šå¯¹éƒ¨åˆ†å€¼åšç¼“å­˜ï¼Œåœ¨åƒ <code>Integer.valueOf(int)</code> è¿™æ ·çš„æ–¹æ³•ä¸­èµ·ä½œç”¨ï¼Œæ‰€ä»¥ä¼šå‡ºç° <code>Integer a = 5; Integer b = 5; assert(a == b);</code> çš„æƒ…å†µã€‚</p><blockquote><p>If the value p being boxed is an integer literal of type int between -128 and 127 inclusive (Â§3.10.1), or the boolean literal true or false (Â§3.10.3), or a character literal between â€˜\u0000â€™ and â€˜\u007fâ€™ inclusive (Â§3.10.4), then let a and b be the results of any two boxing conversions of p. It is always the case that a == b.</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Java ä½œä¸ºä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä»ç„¶ä¿ç•™äº†åŸºæœ¬çš„å‡ ç§å€¼ç±»å‹ï¼ˆintï¼Œshortï¼Œlongï¼Œbyteï¼Œcharï¼Œbooleanï¼Œfloatï¼Œdoubleï¼‰ã€‚å½“ç„¶ä¸ºäº†æ–¹ä¾¿å¼€å‘äººå‘˜ä½¿ç”¨ä¹Ÿæä¾›äº†å¯¹åº”çš„åŒ…è£…ç±»ï¼Œï¼ˆIntegerï¼ŒShortï¼ŒLongï¼ŒByteï¼ŒCharï¼ŒBooleanï¼ŒFloatï¼ŒDoubleï¼‰ï¼Œå¹¶ä¸”åœ¨ Java 1.5 ä¸­å¼€å§‹æä¾›äº†è‡ªåŠ¨è£…ç®±ï¼ˆboxingï¼‰å’Œæ‹†ç®±ï¼ˆunboxingï¼‰ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªåŠ¨è£…ç®±çš„ä¸»è¦ä½œç”¨æ˜¯æ–¹ä¾¿åœ¨å€¼ç±»å‹å’ŒåŒ…è£…ç±»å‹ä¹‹é—´åˆ‡æ¢ï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥åœ¨æºä»£ç é‡Œå°†å€¼ç±»å‹èµ‹å€¼ç»™åŒ…è£…ç±»å‹æˆ–åä¹‹ï¼Œä½¿ç”¨ == æ¥æ¯”è¾ƒå€¼ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„å€¼ã€‚è¿™é‡Œæåˆ°æ˜¯æºä»£ç é‡Œè¿™æ ·åšæ˜¯å› ä¸ºè‡ªåŠ¨è£…ç®±ï¼æ‹†ç®±ç‰¹æ€§ä¸»è¦ç”±ç¼–è¯‘å™¨å¸®æˆ‘ä»¬å®Œæˆã€‚&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>è¿ç§» NDK é¡¹ç›®åˆ° Gradle</title>
    <link href="https://wsxyeah.github.io/2016/09/21/ndk-with-grale/"/>
    <id>https://wsxyeah.github.io/2016/09/21/ndk-with-grale/</id>
    <published>2016-09-21T03:18:49.000Z</published>
    <updated>2016-11-01T13:44:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™å‡ å¤© Android Studio 2.2 ç»ˆäºå‡ºäº†ç¨³å®šç‰ˆï¼Œå®Œå–„äº†å¯¹ NDK çš„æ”¯æŒï¼ŒçœŸå¯è°“æ˜¯ã€Œå¼€å‘è€…çš„å¤§äº‹ï¼Œå¤§å¿«æ‰€æœ‰äººå¿ƒçš„å¤§å¥½äº‹ã€ã€‚</p><h2 id="NDK-é›†æˆ"><a href="#NDK-é›†æˆ" class="headerlink" title="NDK é›†æˆ"></a>NDK é›†æˆ</h2><p>è¿™æ¬¡ Android Studio ä¸ä½†æ”¯æŒä¼ ç»Ÿ NDK é¡¹ç›®çš„é›†æˆï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä½¿ç”¨ Cmake æ¥ç»„ç»‡ NDK ä»£ç ã€‚Cmake é¡¹ç›®å¯ä»¥åœ¨ Gradle åšå¦‚ä¸‹é…ç½®<br><a id="more"></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">externalNativeBuild&#123;</span><br><span class="line">   cmake&#123;</span><br><span class="line">        path &quot;CMakeLists.txt&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defaultConfig &#123;</span><br><span class="line">  externalNativeBuild &#123;</span><br><span class="line">    cmake &#123;</span><br><span class="line">      targets &quot;target1&quot;, &quot;target2&quot;</span><br><span class="line">      arguments &quot;-DANDROID_TOOLCHAIN=clang&quot;</span><br><span class="line">      cFlags &quot;-DTEST_C_FLAG1&quot;, &quot;-DTEST_C_FLAG2&quot;</span><br><span class="line">      cppFlags &quot;-DTEST_CPP_FLAG2&quot;, &quot;-DTEST_CPP_FLAG2&quot;</span><br><span class="line">      abiFilters &quot;armeabi-v7a&quot;, &quot;armeabi&quot;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¼ ç»Ÿçš„ NDK é¡¹ç›®ç°åœ¨å¯ä»¥åœ¨ Gradle é‡Œæ·»åŠ å¦‚ä¸‹é…ç½®å—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">externalNativeBuild&#123;</span><br><span class="line">   ndkBuild&#123;</span><br><span class="line">        path &quot;Android.mk&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defaultConfig &#123;</span><br><span class="line">  externalNativeBuild &#123;</span><br><span class="line">    ndkBuild &#123;</span><br><span class="line">      targets &quot;target1&quot;, &quot;target2&quot;</span><br><span class="line">      arguments &quot;NDK_APPLICATION_MK:=Application.mk&quot;</span><br><span class="line">      cFlags &quot;-DTEST_C_FLAG1&quot;, &quot;-DTEST_C_FLAG2&quot;</span><br><span class="line">      cppFlags &quot;-DTEST_CPP_FLAG2&quot;, &quot;-DTEST_CPP_FLAG2&quot;</span><br><span class="line">      abiFilters &quot;armeabi-v7a&quot;, &quot;armeabi&quot;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>path</code> Android.mk æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„</p><p><code>targets</code> ç”¨æ¥è¿‡æ»¤éœ€è¦æ‰“åŒ…è¿› apk çš„åº“ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒçš„ product flavor åšé…ç½®ã€‚åªæœ‰è¿™é‡ŒæŒ‡å®šçš„ targets æ‰ä¼šè¢«æ‰“åŒ…ï¼Œè‹¥æœªé…ç½®åˆ™å…¨éƒ¨æ‰“åŒ…</p><p><code>abiFilters</code> è¿™é‡Œæœ€å¥½è¿˜æ˜¯å†æŒ‡å®šä¸€æ¬¡ï¼ŒApplication.mk é‡ŒæŒ‡å®šçš„ä¼¼ä¹ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœ NDK é¡¹ç›®ä¾èµ–ä¸€äº›å¹³å°ç›¸å…³çš„åº“æˆ–ä»£ç å¹¶ä¸”åªæœ‰éƒ¨åˆ†å¹³å°çš„ä¾èµ–ï¼Œè¿™æ—¶ä¼šæŠ¥æ‰¾ä¸åˆ°æ–‡ä»¶çš„é”™è¯¯ï¼Œå…¶å®æ˜¯æ²¡æœ‰è®¾ç½® abiFilters å¯¼è‡´å®ƒä¼šå»æ‰¾æ‰€æœ‰å¹³å°çš„æ–‡ä»¶</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>å®Œæˆé…ç½®å¹¶åŒæ­¥ Gradle ä¹‹åï¼Œåœ¨è¯¥æ¨¡å—çš„ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ª <code>.externalNativeBuild</code> ç›®å½•ï¼Œç›®å½•ç»“æ„ä¸º <code>.externalNativeBuild/ndkBuild/${ProductFlavor}/${abi}/</code>ã€‚<br>é‡Œé¢æ˜¯ç”Ÿæˆçš„æ„å»ºè„šæœ¬ï¼ŒåŒ…å«ä¸‰ä¸ªæ–‡ä»¶ã€‚æŒ‡å®šäº† Android.mk åŠ Application.mk çš„ä½ç½®ï¼Œndk-build å‘½ä»¤ï¼Œç¼–è¯‘å‚æ•°åŠ toolchains é…ç½®ã€‚<br>å¹¶ä¸”ä»ç”Ÿæˆçš„è„šæœ¬ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºè¿™é‡Œå·²ç»å¯ä»¥æ ¹æ® Gradle ä¸­çš„ Debug/Release æ¨¡å¼ç”Ÿæˆç›¸åº”çš„ç¼–è¯‘å‘½ä»¤äº†ã€‚</p><ul><li>android_gradle_build.json</li><li>ndkBuild_build_command.txt</li><li>ndkBuild_build_output.txt</li></ul><p>å¦‚æ­¤çœ‹æ¥ Gradle é‡‡å–çš„æ˜¯æ ¹æ®æˆ‘ä»¬çš„é…ç½®ç”Ÿæˆå¯¹åº”çš„è„šæœ¬ï¼Œåœ¨å¤–éƒ¨æ‰§è¡Œç¼–è¯‘è„šæœ¬ï¼Œå†å°†ç»“æœè¿›è¡Œæ‰“åŒ…çš„ç­–ç•¥ï¼Œè¿™æ ·ä¾¿ä½¿åŸæ¥çš„é¡¹ç›®æ— ç¼è¿ç§»ï¼ŒåŒæ—¶ä¹Ÿä¸º Cmake è¿™æ ·çš„ç»„ç»‡æ–¹å¼æä¾›äº†æ‰©å±•ã€‚</p><p>å¦å¤–ç°åœ¨å¯ä»¥é’ˆå¯¹ä¸åŒæ¸ é“åšå®šåˆ¶äº†ã€‚å¯ä»¥é€šè¿‡åœ¨ç¼–è¯‘å™¨å‚æ•°ä¸­å®šä¹‰å®çš„æ–¹å¼å°†å‚æ•°ä¼ è¿› JNI ä¸­ï¼Œå†åœ¨ JNI ä»£ç ä¸­åšå¯¹åº”å¤„ç†ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://developer.android.com/studio/projects/add-native-code.html" target="_blank" rel="noopener">Add C and C++ Code to Your Project</a></li><li><a href="http://android-developers.blogspot.com/2016/09/android-studio-2-2.html" target="_blank" rel="noopener">Android Studio 2.2</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™å‡ å¤© Android Studio 2.2 ç»ˆäºå‡ºäº†ç¨³å®šç‰ˆï¼Œå®Œå–„äº†å¯¹ NDK çš„æ”¯æŒï¼ŒçœŸå¯è°“æ˜¯ã€Œå¼€å‘è€…çš„å¤§äº‹ï¼Œå¤§å¿«æ‰€æœ‰äººå¿ƒçš„å¤§å¥½äº‹ã€ã€‚&lt;/p&gt;
&lt;h2 id=&quot;NDK-é›†æˆ&quot;&gt;&lt;a href=&quot;#NDK-é›†æˆ&quot; class=&quot;headerlink&quot; title=&quot;NDK é›†æˆ&quot;&gt;&lt;/a&gt;NDK é›†æˆ&lt;/h2&gt;&lt;p&gt;è¿™æ¬¡ Android Studio ä¸ä½†æ”¯æŒä¼ ç»Ÿ NDK é¡¹ç›®çš„é›†æˆï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä½¿ç”¨ Cmake æ¥ç»„ç»‡ NDK ä»£ç ã€‚Cmake é¡¹ç›®å¯ä»¥åœ¨ Gradle åšå¦‚ä¸‹é…ç½®&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>JNI å¼€å‘ä¸­å­—ç¬¦ç¼–ç çš„ä¸€ç‚¹å‘</title>
    <link href="https://wsxyeah.github.io/2016/07/23/jni-charset-encoding/"/>
    <id>https://wsxyeah.github.io/2016/07/23/jni-charset-encoding/</id>
    <published>2016-07-23T09:39:06.000Z</published>
    <updated>2016-07-23T09:43:16.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‘"><a href="#å‘" class="headerlink" title="å‘"></a>å‘</h2><p>JNI å¼€å‘ä¸­ Java å±‚å‘ä¸‹ä¼ å­—ç¬¦ä¸²æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ JNIEnv çš„ GetStringUTFChars æ–¹æ³•å°† <code>jstring</code> è½¬ä¸º <code>const char *</code>ï¼Œç”¨å®Œåä½¿ç”¨ ReleaseStringUTFChars æ–¹æ³•é‡Šæ”¾ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> jchar * <span class="title">GetStringChars</span><span class="params">(JNIEnv *env, jstring <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">jboolean *isCopy)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ReleaseStringChars</span><span class="params">(JNIEnv *env, jstring <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">const</span> jchar *chars)</span></span>;</span><br></pre></td></tr></table></figure><p>ç„¶è€Œä½¿ç”¨è¯¥æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²å´å¹¶éé‡‡ç”¨æ ‡å‡† UTF-8 ç¼–ç ï¼Œè€Œæ˜¯Modified UTF-8 Stringsï¼Œå³ä¸€ç§ä¿®æ”¹è¿‡çš„ UTF-8 ç¼–ç ã€‚</p><a id="more"></a><p>æ ‡å‡†çš„ UTF-8 ç¼–ç ä»¥ 8-bit å³ä¸€ä¸ªå­—èŠ‚ä¸ºåŸºæœ¬å•ä½ï¼Œä¸€ä¸ªå­—ç¬¦å¯ä»¥ç”±ä¸€åˆ°å…­ä¸ªå­—èŠ‚ç¼–ç è¡¨ç¤ºï¼Œåªè¦ç•™å‡ºæ¯ä¸ªå­—èŠ‚çš„é«˜å‡ ä½ä½œä¸ºæ ‡å¿—ä½å°±å¯ä»¥è¡¨ç¤ºå‡ºè¯¥å­—èŠ‚çš„ç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­å‡ºå…¶åæœ‰å‡ ä¸ªå­—èŠ‚ä¸è¯¥å­—èŠ‚åˆåœ¨ä¸€èµ·è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚æ¯”å¦‚æœ€é«˜ä½ä¸º <code>0</code> è¡¨ç¤ºè¯¥å­—èŠ‚å•ç‹¬è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼›æœ€é«˜ä¸¤ä½ä¸º <code>10</code> è¡¨ç¤ºè¯¥å­—èŠ‚æ˜¯è·Ÿåœ¨å…¶ä»–å­—èŠ‚åé¢çš„ï¼Œä»…åŒ…å«æ•°æ®ï¼›æœ€é«˜ä¸‰ä½ä¸º <code>110</code> åˆ™è¡¨ç¤ºå®ƒå°†ä¸åä¸€ä¸ªå­—èŠ‚å…±åŒè¡¨ç¤ºåŒä¸€å­—ç¬¦ã€‚</p><p>åœ¨ Modified UTF-8 Strings ä¸­ï¼Œ<code>U+FFFF</code> ä»¥ä¸Šç¼–ç çš„å­—ç¬¦ï¼ˆæ¯”å¦‚ Emoji å­—ç¬¦ï¼‰å¹¶æ²¡æœ‰ç»§ç»­éµå¾ª UTF-8 ç¼–ç çš„è§„åˆ™ï¼Œè€Œæ˜¯å°†å…¶æ‹†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸‰ä¸ªå­—èŠ‚å­˜æ”¾ï¼Œå…±å…­ä¸ªå­—èŠ‚ã€‚ä½†è¿™æ ·ä¹Ÿå°±å¯¼è‡´äº†ä½¿ç”¨ UTF-8 ç¼–ç è§£æçš„è¯ä¾¿å°†ä¼šå…¶è¯†åˆ«ä¸ºä¸¤ä¸ªå­—ç¬¦ã€‚</p><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>1</td><td>0</td><td>1</td><td>0</td><td></td><td></td><td></td><td></td></tr><tr><td>1</td><td>0</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>1</td><td>0</td><td>1</td><td>1</td><td></td><td></td><td></td><td></td></tr><tr><td>1</td><td>0</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ä¸»è¦æœ‰çš„è§£å†³æ€è·¯æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ UTF-16 ç¼–ç ï¼Œç³»ç»Ÿæä¾›äº†å¯¹åº”çš„ GetStringChars å’Œ ReleaseStringChars æ–¹æ³•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> jchar * <span class="title">GetStringChars</span><span class="params">(JNIEnv *env, jstring <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">jboolean *isCopy)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ReleaseStringChars</span><span class="params">(JNIEnv *env, jstring <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">const</span> jchar *chars)</span></span>;</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ˜¯å…ˆåœ¨ Java å±‚æ‹¿åˆ° UTF-8 ç¼–ç çš„å­—ç¬¦ä¸² byte[] æ•°æ®ï¼Œå†ä»¥ jbyteArray çš„å½¢å¼ä¼ å…¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] data = str.getBytes(<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jbyteArray _bytes;</span></span><br><span class="line"><span class="keyword">const</span> jsize length = env-&gt;GetArrayLength(_bytes);</span><br><span class="line">jbyte *bytes = env-&gt;GetByteArrayElements(_bytes, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">env-&gt;ReleaseByteArrayElements(_bytes, bytes, JNI_ABORT);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‘&quot;&gt;&lt;a href=&quot;#å‘&quot; class=&quot;headerlink&quot; title=&quot;å‘&quot;&gt;&lt;/a&gt;å‘&lt;/h2&gt;&lt;p&gt;JNI å¼€å‘ä¸­ Java å±‚å‘ä¸‹ä¼ å­—ç¬¦ä¸²æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ JNIEnv çš„ GetStringUTFChars æ–¹æ³•å°† &lt;code&gt;jstring&lt;/code&gt; è½¬ä¸º &lt;code&gt;const char *&lt;/code&gt;ï¼Œç”¨å®Œåä½¿ç”¨ ReleaseStringUTFChars æ–¹æ³•é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; jchar * &lt;span class=&quot;title&quot;&gt;GetStringChars&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(JNIEnv *env, jstring &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;jboolean *isCopy)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReleaseStringChars&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(JNIEnv *env, jstring &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; jchar *chars)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶è€Œä½¿ç”¨è¯¥æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²å´å¹¶éé‡‡ç”¨æ ‡å‡† UTF-8 ç¼–ç ï¼Œè€Œæ˜¯Modified UTF-8 Stringsï¼Œå³ä¸€ç§ä¿®æ”¹è¿‡çš„ UTF-8 ç¼–ç ã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Ubuntu 16.04 ä¸‹æ­å»º Samba æœåŠ¡</title>
    <link href="https://wsxyeah.github.io/2016/05/22/ubuntu-samba-service/"/>
    <id>https://wsxyeah.github.io/2016/05/22/ubuntu-samba-service/</id>
    <published>2016-05-22T12:23:56.000Z</published>
    <updated>2016-05-22T13:00:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘è¦è¯»æºç çš„æ—¶å€™éƒ½è¦åˆ°ç½‘é¡µä¸Šæ‰¾ï¼Œç½‘é¡µè·³è½¬ä¸ä»…é€Ÿåº¦æ…¢ä¹Ÿååˆ†éº»çƒ¦ï¼Œäºæ˜¯æ‰“ç®—æŠŠ AOSP æºç åŒæ­¥åˆ°æœ¬åœ°ã€‚<br>ç”±äºæˆ‘çš„ Mac å‰©ä½™ç£ç›˜ç©ºé—´åªæœ‰ 100 å¤š G äº†ï¼Œå°±ç”¨åŸæ¥è”æƒ³çš„æœºå™¨ï¼ˆç”¨çš„æ˜¯ Ubuntu 16.04ï¼‰åŒæ­¥äº† 24GB+ çš„ AOSP æºç ã€‚å¹¶æ‰“ç®—åœ¨ä¸Šé¢æ­å»º Samba æœåŠ¡ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥åœ¨ Mac ä¸Šé˜…è¯»æºç äº†ï¼Œå“ˆå“ˆã€‚</p><a id="more"></a><h2 id="å®‰è£…-Samba"><a href="#å®‰è£…-Samba" class="headerlink" title="å®‰è£… Samba"></a>å®‰è£… Samba</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install samba</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©å…±äº«ç›®å½•"><a href="#é€‰æ‹©å…±äº«ç›®å½•" class="headerlink" title="é€‰æ‹©å…±äº«ç›®å½•"></a>é€‰æ‹©å…±äº«ç›®å½•</h2><p>ç›´æ¥åœ¨ Ubuntu çš„æ–‡ä»¶ç®¡ç†å™¨ GUI å³é”®èœå•é‡Œé€‰æ‹© å±æ€§ -&gt; æœ¬åœ°æ–‡ä»¶å…±äº«ï¼Œå¹¶å‹¾é€‰<code>å…±äº«æ­¤ç›®å½•</code>ä»¥åŠ<code>å…è®¸å…¶ä»–äººæ¥åˆ›å»ºå’Œåˆ é™¤è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶</code>å°±å¯ä»¥äº†ï¼Œç³»ç»Ÿä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨è®¾ç½®ç›®å½•çš„æƒé™åŠå…±äº«é…ç½®ã€‚</p><h2 id="æ·»åŠ ç”¨æˆ·"><a href="#æ·»åŠ ç”¨æˆ·" class="headerlink" title="æ·»åŠ ç”¨æˆ·"></a>æ·»åŠ ç”¨æˆ·</h2><p>æˆ‘ä»¬å¯ä»¥å•ç‹¬åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç”¨äºç™»å½• Samba æœåŠ¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd smb</span><br><span class="line">sudo passwd smb</span><br></pre></td></tr></table></figure><p>å…è®¸ä½¿ç”¨è¯¥ç”¨æˆ·ç™»å½• Samba å¹¶é‡å¯ Samba æœåŠ¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo smbpasswd -a smb &amp;&amp; sudo service smbd restart</span><br></pre></td></tr></table></figure><p>ç°åœ¨åªè¦åœ¨ Finder å·¦ä¾§è¾¹æ é€‰æ‹©æœåŠ¡å™¨ï¼Œç‚¹å‡» <code>Connect as</code> å¹¶ä½¿ç”¨åˆ›å»ºçš„è´¦æˆ·ç™»å½•å°±å¯ä»¥ç›´æ¥è®¿é—®å…±äº«ç›®å½•å•¦ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘è¦è¯»æºç çš„æ—¶å€™éƒ½è¦åˆ°ç½‘é¡µä¸Šæ‰¾ï¼Œç½‘é¡µè·³è½¬ä¸ä»…é€Ÿåº¦æ…¢ä¹Ÿååˆ†éº»çƒ¦ï¼Œäºæ˜¯æ‰“ç®—æŠŠ AOSP æºç åŒæ­¥åˆ°æœ¬åœ°ã€‚&lt;br&gt;ç”±äºæˆ‘çš„ Mac å‰©ä½™ç£ç›˜ç©ºé—´åªæœ‰ 100 å¤š G äº†ï¼Œå°±ç”¨åŸæ¥è”æƒ³çš„æœºå™¨ï¼ˆç”¨çš„æ˜¯ Ubuntu 16.04ï¼‰åŒæ­¥äº† 24GB+ çš„ AOSP æºç ã€‚å¹¶æ‰“ç®—åœ¨ä¸Šé¢æ­å»º Samba æœåŠ¡ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥åœ¨ Mac ä¸Šé˜…è¯»æºç äº†ï¼Œå“ˆå“ˆã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æµ…è°ˆ Android äº‹ä»¶åˆ†å‘æœºåˆ¶</title>
    <link href="https://wsxyeah.github.io/2016/04/03/touch-event/"/>
    <id>https://wsxyeah.github.io/2016/04/03/touch-event/</id>
    <published>2016-04-03T13:30:04.000Z</published>
    <updated>2016-04-03T23:59:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-å½¢å¼"><a href="#1-å½¢å¼" class="headerlink" title="1. å½¢å¼"></a>1. å½¢å¼</h2><p>Touch äº‹ä»¶è¢«å°è£…æˆ MotionEvent å¯¹è±¡æ¥ä¼ é€’ã€‚<br>ç”± ACTION_DOWN å¼€å§‹ï¼Œç»è¿‡è‹¥å¹²æ¬¡ ACTION_MOVE å¹¶ä»¥ ACTION_UP ç»“æŸçš„ä¸€ä¸ªäº‹ä»¶åºåˆ—ç§°ä¸ºä¸€ä¸ª gestureã€‚</p><h2 id="2-è§’è‰²"><a href="#2-è§’è‰²" class="headerlink" title="2. è§’è‰²"></a>2. è§’è‰²</h2><p>æ¶‰åŠ Touch äº‹ä»¶å¤„ç†çš„è§’è‰²æœ‰å››ç§ï¼š</p><ul><li>Activity</li><li>Window</li><li>ViewGroup</li><li>View</li></ul><a id="more"></a><h2 id="3-åŸºæœ¬æµç¨‹"><a href="#3-åŸºæœ¬æµç¨‹" class="headerlink" title="3. åŸºæœ¬æµç¨‹"></a>3. åŸºæœ¬æµç¨‹</h2><p>äº‹ä»¶åœ¨ activity ä¸­çš„åˆ†å‘èµ·å§‹äº <code>dispatchTouchEvent()</code> æ–¹æ³•ã€‚ä»æºç å¯ä»¥çœ‹å‡º activity è°ƒç”¨äº† Window çš„ <code>superDispatchTouchEvent()</code> æ–¹æ³•æ¥å¤„ç†ï¼Œè‹¥è¿”å›å€¼ä¸º trueï¼Œåˆ™ç»“æŸäº‹ä»¶åˆ†å‘ï¼Œå¦åˆ™è°ƒç”¨ <code>onTouchEvent()</code>  æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (ev.getAction() == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">onUserInteraction();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (getWindow().superDispatchTouchEvent(ev)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> onTouchEvent(ev);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Window çš„å®ç°ç±»ä¸º PhoneWindowï¼ŒPhoneWindow å®é™…è°ƒç”¨äº† DecorView çš„ <code>superDispatchTouchEvent()</code>ã€‚<br>è€Œ DecorView æ˜¯ activity ä¸­çš„é¡¶çº§ Viewï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ª FrameLayoutï¼Œå®ƒçš„ <code>superDispatchTouchEvent()</code> ç›´æ¥è°ƒç”¨äº† ViewGroup çš„ <code>dispatchTouchEvent()</code>ã€‚</p><p>ç”±æ­¤ï¼Œäº‹ä»¶æµå…¥ View å±‚çº§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PhoneWindow</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">superDispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> mDecor.superDispatchTouchEvent(event);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// DecorView</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">superDispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-ViewGroup-dispatchTouchEvent-æµç¨‹"><a href="#4-ViewGroup-dispatchTouchEvent-æµç¨‹" class="headerlink" title="4. ViewGroup dispatchTouchEvent() æµç¨‹"></a>4. ViewGroup <code>dispatchTouchEvent()</code> æµç¨‹</h2><p>äº‹ä»¶æµå…¥ View å±‚çº§åä¼šé€çº§åˆ†å‘ï¼ŒViewGroup å¤„åœ¨äº‹ä»¶åˆ†å‘çš„ä¸­é—´å±‚ï¼Œæ˜¯äº‹ä»¶åˆ†å‘æœºåˆ¶ä¸­æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚æ­¤å¤„æºç éå¸¸é•¿ï¼Œå°±ä¸è´´å‡ºæ¥äº†ã€‚</p><p>ACTION_DOWN äº‹ä»¶ä½œä¸ºä¸€æ¬¡ gesture çš„å¼€å§‹ï¼Œå¯ä»¥å½±å“åç»­äº‹ä»¶çš„ä¼ é€’æµç¨‹ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè¿™é‡Œå°†å®ƒä¸å…¶ä»–ç±»å‹çš„äº‹ä»¶åˆ†å¼€åˆ†æã€‚</p><ul><li>å¯¹äº ACITON_DOWN äº‹ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</span><br><span class="line"><span class="keyword">boolean</span> handled = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. ä½œä¸ºä¸€æ¬¡ gesture çš„å¼€å§‹ï¼Œé‡ç½®çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆªæœ¬æ¬¡äº‹ä»¶</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">boolean</span> intercepted;</span><br><span class="line"><span class="keyword">if</span> (!disallowIntercept) &#123;</span><br><span class="line"><span class="comment">// æ­¤æ—¶ disallowIntercept å·²è¢«é‡ç½®ä¸º falseï¼ŒonInterceptTouchEvent ä¸€å®šä¼šè¢«è°ƒç”¨</span></span><br><span class="line">intercepted = onInterceptTouchEvent(ev);</span><br><span class="line">ev.setAction(action); <span class="comment">// restore action in case it was changed</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">intercepted = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!intercepted &amp;&amp; mChildrenCount != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">// 3.a ä¸è¿›è¡Œæ‹¦æˆªçš„æƒ…å†µï¼Œå‘ä¸‹åˆ†å‘</span></span><br><span class="line"> <span class="comment">// ä»å‰é¢åˆ°åé¢éå†å­ Viewï¼Œè¿™é‡Œç”¨å¾ªç¯ä»…ç®€å•è¡¨ç¤ºéå†è¿‡ç¨‹</span></span><br><span class="line"> <span class="keyword">for</span> (View child : mChildren) &#123;</span><br><span class="line"> <span class="keyword">if</span> (!canViewReceivePointerEvents(child)</span><br><span class="line">|| !isTransformedTouchPointInView(x, y, child, <span class="keyword">null</span>)) &#123;</span><br><span class="line"><span class="comment">// è¯¥å­ View ä¸å¯è§æˆ–è§¦æ‘¸ä½ç½®ä¸åœ¨å­ View è¾¹ç•Œå†…ï¼Œè·³è¿‡</span></span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å˜æ¢ MotionEvent å¹¶ä¼ ç»™å­ View çš„ dispatchTouchEvent</span></span><br><span class="line"><span class="keyword">if</span> (dispatchTransformedTouchEvent(ev, <span class="keyword">false</span>, child, idBitsToAssign)) &#123;</span><br><span class="line"><span class="comment">// è‹¥è¿”å› trueï¼Œè¡¨ç¤ºè¯¥å­ View éœ€è¦å¤„ç†æ­¤æ¬¡ gesture çš„äº‹ä»¶ï¼Œè®°å½•æ­¤çŠ¶æ€</span></span><br><span class="line">handled = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 3.b è¿›è¡Œæ‹¦æˆªçš„æƒ…å†µï¼Œéœ€è¦è‡ªå·±å¤„ç†äº‹ä»¶</span></span><br><span class="line">handled = <span class="keyword">super</span>.dispatchTouchEvent(event);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> handled;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯¹äºé ACITON_DOWN äº‹ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</span><br><span class="line"><span class="keyword">boolean</span> handled = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. åˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆªæœ¬æ¬¡äº‹ä»¶</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">boolean</span> intercepted;</span><br><span class="line"><span class="keyword">if</span> (!disallowIntercept) &#123;</span><br><span class="line">intercepted = onInterceptTouchEvent(ev);</span><br><span class="line">ev.setAction(action); <span class="comment">// restore action in case it was changed</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// è‹¥ä¹‹å‰å­ View è°ƒç”¨äº† requestDisallowInterceptTouchEvent(true)ï¼Œåˆ™ä¸å…è®¸æ‹¦æˆª</span></span><br><span class="line">intercepted = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!intercepted &amp;&amp; mChildrenCount != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">// 2.a ä¸è¿›è¡Œæ‹¦æˆªçš„æƒ…å†µï¼Œå‘ä¸‹åˆ†å‘</span></span><br><span class="line"> <span class="comment">// ä»…éå†ä¹‹å‰è®°å½•çš„å­ Viewï¼ˆå³å¯¹ ACTION_DOWN äº‹ä»¶è¿”å› true çš„å­ Viewï¼‰</span></span><br><span class="line"> <span class="comment">// è¿™é‡Œå¾ªç¯ä»…ç®€å•è¡¨ç¤ºéå†è¿‡ç¨‹ï¼Œå®é™…ä¸Šæºç æ˜¯ä½¿ç”¨é“¾è¡¨å®ç°çš„</span></span><br><span class="line"> <span class="keyword">for</span> (View child : children) &#123;</span><br><span class="line"><span class="comment">// å˜æ¢ MotionEvent å¹¶ä¼ ç»™å­ View çš„ dispatchTouchEvent</span></span><br><span class="line"><span class="keyword">if</span> (dispatchTransformedTouchEvent(ev, <span class="keyword">false</span>, child, idBitsToAssign)) &#123;</span><br><span class="line">handled = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 2.b è¿›è¡Œæ‹¦æˆªçš„æƒ…å†µï¼Œéœ€è¦è‡ªå·±å¤„ç†äº‹ä»¶</span></span><br><span class="line">handled = <span class="keyword">super</span>.dispatchTouchEvent(event);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> handled;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-View-dispatchTouchEvent-æµç¨‹"><a href="#5-View-dispatchTouchEvent-æµç¨‹" class="headerlink" title="5. View dispatchTouchEvent() æµç¨‹"></a>5. View <code>dispatchTouchEvent()</code> æµç¨‹</h2><p>View ä½äºäº‹ä»¶åˆ†å‘çš„æœ€ä¸‹å±‚ï¼Œä¸å†å‘ä¸‹åˆ†å‘ã€‚View çš„äº‹ä»¶åˆ†å‘é€»è¾‘å¤§è‡´ç­‰æ•ˆäº <code>return mOnTouchListener.onTouch(this, e) || onTouchEvent(e);</code>ã€‚</p><p>View çš„ OnClickListener æ˜¯åœ¨ <code>onTouchEvent()</code> æ–¹æ³•é‡Œå›è°ƒçš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ä¸º View è®¾ç½®äº† onTouchListener å¹¶åœ¨ <code>onTouch()</code> é‡Œè¿”å› trueï¼Œé‚£ä¹ˆå®ƒçš„ OnClick ç­‰ç³»ç»Ÿé¢„è®¾çš„äº‹ä»¶ä¼šå¤±æ•ˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®€åŒ–çš„ View dispatchTouchEvent ä»£ç </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line"><span class="keyword">boolean</span> result = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">ListenerInfo li = mListenerInfo;</span><br><span class="line"><span class="keyword">if</span> (li != <span class="keyword">null</span> &amp;&amp; li.mOnTouchListener != <span class="keyword">null</span></span><br><span class="line"> &amp;&amp; (mViewFlags &amp; ENABLED_MASK) == ENABLED</span><br><span class="line">&amp;&amp; li.mOnTouchListener.onTouch(<span class="keyword">this</span>, event)) &#123;</span><br><span class="line">result = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!result &amp;&amp; onTouchEvent(event)) &#123;</span><br><span class="line">result = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-å½¢å¼&quot;&gt;&lt;a href=&quot;#1-å½¢å¼&quot; class=&quot;headerlink&quot; title=&quot;1. å½¢å¼&quot;&gt;&lt;/a&gt;1. å½¢å¼&lt;/h2&gt;&lt;p&gt;Touch äº‹ä»¶è¢«å°è£…æˆ MotionEvent å¯¹è±¡æ¥ä¼ é€’ã€‚&lt;br&gt;ç”± ACTION_DOWN å¼€å§‹ï¼Œç»è¿‡è‹¥å¹²æ¬¡ ACTION_MOVE å¹¶ä»¥ ACTION_UP ç»“æŸçš„ä¸€ä¸ªäº‹ä»¶åºåˆ—ç§°ä¸ºä¸€ä¸ª gestureã€‚&lt;/p&gt;
&lt;h2 id=&quot;2-è§’è‰²&quot;&gt;&lt;a href=&quot;#2-è§’è‰²&quot; class=&quot;headerlink&quot; title=&quot;2. è§’è‰²&quot;&gt;&lt;/a&gt;2. è§’è‰²&lt;/h2&gt;&lt;p&gt;æ¶‰åŠ Touch äº‹ä»¶å¤„ç†çš„è§’è‰²æœ‰å››ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Activity&lt;/li&gt;
&lt;li&gt;Window&lt;/li&gt;
&lt;li&gt;ViewGroup&lt;/li&gt;
&lt;li&gt;View&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Android æ—¥æœŸè§£æä¸æ ¼å¼åŒ–</title>
    <link href="https://wsxyeah.github.io/2016/03/13/date-format/"/>
    <id>https://wsxyeah.github.io/2016/03/13/date-format/</id>
    <published>2016-03-13T00:33:39.000Z</published>
    <updated>2016-04-04T00:23:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>Java ä¸­æœ‰ <code>java.text.DateFormat</code> è¿™ä¸ªç±»æ¥ä¸“é—¨å¤„ç†æ—¥æœŸæ ¼å¼ï¼Œå®ƒçš„å®ä¾‹ä»…èƒ½é€šè¿‡ä¸‰ä¸ªå·¥å‚æ–¹æ³•è·å–ï¼Œç„¶åå°±å¯ä»¥è°ƒç”¨ <code>format()</code> å’Œ <code>parse()</code> æ–¹æ³•æ¥æ ¼å¼åŒ–å’Œè§£æäº†ã€‚</p><ul><li><code>DateFormat.getDateInstance([int style[, Locale aLocale]])</code></li><li><code>DateFormat.getDateTimeInstance([int dateStyle, int timeStyle[, Locale aLocale]])</code></li><li><code>DateFormat.getTimeInstance([int style[, Locale aLocale]])</code></li></ul><p>å…¶ä¸­çš„ style å¯ä»¥æ˜¯ SHORTï¼Œ MEDIUMï¼Œ LONG æˆ–è€… FULLã€‚</p><ul><li>SHORT is completely numeric, such as 12.13.52 or 3:30pm</li><li>MEDIUM is longer, such as Jan 12, 1952</li><li>LONG is longer, such as January 12, 1952 or 3:30:32pm</li><li>FULL is pretty completely specified, such as Tuesday, April 12, 1952 AD or 3:30:42pm PST.</li></ul><a id="more"></a><p>æˆ‘ä»¬å¸¸ç”¨çš„æ˜¯å…¶å­ç±» <code>SimpleDateFormat</code>ï¼Œå®ƒå¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸² pattern æ¥å®šä¹‰æ ¼å¼ï¼Œè¯¦ç»†æ–‡æ¡£å¯ä»¥çœ‹è¿™é‡Œ <a href="http://developer.android.com/intl/zh-cn/reference/java/text/SimpleDateFormat.html" target="_blank" rel="noopener">http://developer.android.com/intl/zh-cn/reference/java/text/SimpleDateFormat.html</a>ã€‚</p><p><strong>å‘å‡ºæ²¡æ³¨æ„</strong><br><strong>å¦‚æœè¦è§£æçš„æ—¥æœŸå­—ç¬¦ä¸²ä¸æ˜¯çº¯æ•°å­—ï¼ˆæ¯”å¦‚å«æœ‰ç”¨æ–‡å­—è¡¨ç¤ºçš„çš„æœˆä»½æˆ–è€…å‘¨å‡ ï¼‰çš„è¯ï¼Œä¸€å®šè¦è®°å¾—ä¼ å…¥ Localeã€‚</strong></p><p>å¦å¤–ä¸€ç§æ—¥æœŸçš„æ ¼å¼åŒ–é—®é¢˜å°±æ˜¯å¼„æˆé‚£ç§åƒ <code>2å°æ—¶å‰</code>ï¼Œ<code>1å¤©å‰</code> è¿™æ ·çš„æ ¼å¼ã€‚Android å…¶å®è‡ªå¸¦äº†ä¸€ä¸ª <code>DataUtils</code> ç±»æ¥å¤„ç†è¿™ç§æ ¼å¼ã€‚</p><p><code>formatDateRange()</code> å¯ä»¥æ ¼å¼åŒ–æ—¶é—´æ®µï¼Œæ¯”å¦‚ <code>3:00pm - 4:00pm</code>ï¼Œæˆ–è€… <code>Dec 31, 2007 - Jan 1, 2008</code>ã€‚<br><code>formatElapsedTime()</code> å¯ä»¥ä¼ å…¥ç§’æ•°ï¼Œæ ¼å¼åŒ–æˆ <code>MM:SS</code> æˆ– <code>H:MM:SS</code>ã€‚<br><code>formatSameDayTime</code> éœ€è¦ä¼ å…¥ now å‚æ•°ï¼Œå¯¹åœ¨åŒä¸€å¤©çš„æ—¶é—´æ˜¾ç¤ºæ—¶é—´ï¼Œä¸æ˜¯åŒä¸€å¤©åˆ™ä»…æ˜¾ç¤ºæ—¥æœŸã€‚<br><code>getRelativeDateTimeString()</code> å°±æ˜¯æˆ‘ä»¬å¸¸è§çš„ <code>2å°æ—¶å‰</code> æ ¼å¼äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Java ä¸­æœ‰ &lt;code&gt;java.text.DateFormat&lt;/code&gt; è¿™ä¸ªç±»æ¥ä¸“é—¨å¤„ç†æ—¥æœŸæ ¼å¼ï¼Œå®ƒçš„å®ä¾‹ä»…èƒ½é€šè¿‡ä¸‰ä¸ªå·¥å‚æ–¹æ³•è·å–ï¼Œç„¶åå°±å¯ä»¥è°ƒç”¨ &lt;code&gt;format()&lt;/code&gt; å’Œ &lt;code&gt;parse()&lt;/code&gt; æ–¹æ³•æ¥æ ¼å¼åŒ–å’Œè§£æäº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DateFormat.getDateInstance([int style[, Locale aLocale]])&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DateFormat.getDateTimeInstance([int dateStyle, int timeStyle[, Locale aLocale]])&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DateFormat.getTimeInstance([int style[, Locale aLocale]])&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä¸­çš„ style å¯ä»¥æ˜¯ SHORTï¼Œ MEDIUMï¼Œ LONG æˆ–è€… FULLã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SHORT is completely numeric, such as 12.13.52 or 3:30pm&lt;/li&gt;
&lt;li&gt;MEDIUM is longer, such as Jan 12, 1952&lt;/li&gt;
&lt;li&gt;LONG is longer, such as January 12, 1952 or 3:30:32pm&lt;/li&gt;
&lt;li&gt;FULL is pretty completely specified, such as Tuesday, April 12, 1952 AD or 3:30:42pm PST.&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æˆ‘å¯¹ Android æ¶ˆæ¯æœºåˆ¶çš„æ€è€ƒ</title>
    <link href="https://wsxyeah.github.io/2016/03/03/thinking-about-handler/"/>
    <id>https://wsxyeah.github.io/2016/03/03/thinking-about-handler/</id>
    <published>2016-03-03T13:00:42.000Z</published>
    <updated>2016-11-24T13:43:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>Android ä¸­çº¿ç¨‹é—´é€šä¿¡æ¶ˆæ¯æœºåˆ¶çš„åŸºæœ¬æ€æƒ³å…¶å®å¾ˆç®€å•ï¼šä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ç”¨æ¥â€œç›‘å¬â€æ¶ˆæ¯ï¼Œä¹‹åæˆ‘ä»¬åªè¦åœ¨å…¶ä»–çº¿ç¨‹ä¸­å‘ç›®æ ‡çº¿ç¨‹å‘é€æ¶ˆæ¯å°±å¯ä»¥è¢«ç›®æ ‡çº¿ç¨‹æ¥æ”¶å¹¶å¤„ç†ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åˆ†æè¿™ä¸ªæœºåˆ¶çš„å®ç°ï¼ˆä»¥ä¸‹æºç å‡åŸºäº SDK 23ï¼‰ã€‚</p><a id="more"></a><h2 id="1-ä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ç”¨æ¥â€œç›‘å¬â€æ¶ˆæ¯"><a href="#1-ä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ç”¨æ¥â€œç›‘å¬â€æ¶ˆæ¯" class="headerlink" title="1. ä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ç”¨æ¥â€œç›‘å¬â€æ¶ˆæ¯"></a>1. ä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ç”¨æ¥â€œç›‘å¬â€æ¶ˆæ¯</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ Java ä¸­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„å…¥å£ç‚¹æ˜¯å®ƒçš„ <code>run()</code> æ–¹æ³•ï¼ˆæˆ–è€…å¯¹åº” Runable å¯¹è±¡çš„ <code>run()</code> æ–¹æ³•ï¼‰ï¼Œæˆ‘ä»¬è¦ä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹æ¶ˆæ¯å¾ªç¯å°±éœ€è¦åœ¨æ­¤å¤„è¿›è¡Œæ“ä½œï¼Œå¦åˆ™çº¿ç¨‹ä»£ç ä¸€ä¸‹å­å°±æ‰§è¡Œå®Œäº†ï¼Œç»“æŸæ‰äº†ã€‚</p><p>è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ Looper æ¥å®Œæˆè¿™ä¸ªå·¥ä½œäº†ï¼Œä»å…¶å‘½åæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥å®ƒæ˜¯ä½œä¸ºä¸€ä¸ªâ€œå¾ªç¯å™¨â€æ¥ä½¿ç”¨ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿åœ°ä¸ºæˆ‘ä»¬çš„çº¿ç¨‹å»ºç«‹æ¶ˆæ¯å¾ªç¯ã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨ Looper çš„æ—¶å€™éƒ½æ˜¯å…ˆè°ƒç”¨ <code>Looper.prepare()</code> ,ç„¶ååˆ›å»º Handler ä½œä¸ºæ¶ˆæ¯å¤„ç†å™¨ï¼Œæœ€åå†è°ƒç”¨ <code>Looper.loop()</code> æ¥å¯åŠ¨æ¶ˆæ¯å¾ªç¯ã€‚</p><p>é‚£ä¹ˆ <code>Looper.prepare()</code> å¹²äº†äº›ä»€ä¹ˆäº‹æƒ…å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…¶æºç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/** Initialize the current thread as a looper.</span></span><br><span class="line"><span class="comment">  * This gives you a chance to create handlers that then reference</span></span><br><span class="line"><span class="comment">  * this looper, before actually starting the loop. Be sure to call</span></span><br><span class="line"><span class="comment">  * &#123;<span class="doctag">@link</span> #loop()&#125; after calling this method, and end it by calling</span></span><br><span class="line"><span class="comment">  * &#123;<span class="doctag">@link</span> #quit()&#125;.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    prepare(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sThreadLocal.get() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Only one Looper may be created per thread"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sThreadLocal.set(<span class="keyword">new</span> Looper(quitAllowed));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">Looper</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</span><br><span class="line">    mQueue = <span class="keyword">new</span> MessageQueue(quitAllowed);</span><br><span class="line">    mThread = Thread.currentThread();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ <code>sThreadLocal</code> æ˜¯ Looper ç±»çš„é™æ€ ThreadLocal ç±»å¯¹è±¡ã€‚è¿™é‡Œå…ˆè¯´æ˜ä¸€ä¸‹ ThreadLocal çš„ä½œç”¨ï¼ŒThreadLocal å°±æ˜¯ç”¨æ¥ä»å½“å‰çº¿ç¨‹å¯¹è±¡é‡Œå­˜å–æ•°æ®çš„ä¸€ä¸ªå·¥å…·ç±»ã€‚<br>ThreadLocal ä½¿ç”¨ <code>Thread.currentThread()</code> æ¥è·å¾—å½“å‰ä»£ç æ‰€åœ¨çš„çº¿ç¨‹å¯¹è±¡ï¼Œç„¶åæŠŠæ•°æ®å­˜åˆ°çº¿ç¨‹å¯¹è±¡ä¸­ï¼Œget ä¹Ÿæ˜¯ä»çº¿ç¨‹å¯¹è±¡é‡Œå–å‡ºæ¥ã€‚</p><p>æˆ‘ä»¬ä»æºç å¯ä»¥çœ‹å‡ºæ¥ <strong><code>Looper.prepare()</code> ä¼šå‘å½“å‰çº¿ç¨‹å¯¹è±¡å­˜æ”¾ä¸€ä¸ª Looper å¯¹è±¡</strong>ï¼Œå¦å¤– Looper å¯¹è±¡åœ¨åˆ›å»ºçš„æ—¶å€™åˆ›å»ºä¸€ä¸ª MessageQueueï¼Œå°†å…¶ä»¥åŠå½“å‰çº¿ç¨‹å¯¹è±¡ä½œä¸ºå¯¹è±¡æˆå‘˜ã€‚</p><p>å†æ¥çœ‹ Handler çš„åˆ›å»ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Use the &#123;<span class="doctag">@link</span> Looper&#125; for the current thread with the specified callback interface</span></span><br><span class="line"><span class="comment"> * and set whether the handler should be asynchronous.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Handlers are synchronous by default unless this constructor is used to make</span></span><br><span class="line"><span class="comment"> * one that is strictly asynchronous.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Asynchronous messages represent interrupts or events that do not require global ordering</span></span><br><span class="line"><span class="comment"> * with respect to synchronous messages.  Asynchronous messages are not subject to</span></span><br><span class="line"><span class="comment"> * the synchronization barriers introduced by &#123;<span class="doctag">@link</span> MessageQueue#enqueueSyncBarrier(long)&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> callback The callback interface in which to handle messages, or null.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> async If true, the handler calls &#123;<span class="doctag">@link</span> Message#setAsynchronous(boolean)&#125; for</span></span><br><span class="line"><span class="comment"> * each &#123;<span class="doctag">@link</span> Message&#125; that is sent to it or &#123;<span class="doctag">@link</span> Runnable&#125; that is posted to it.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@hide</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(Callback callback, <span class="keyword">boolean</span> async)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (FIND_POTENTIAL_LEAKS) &#123;</span><br><span class="line">        <span class="keyword">final</span> Class&lt;? extends Handler&gt; klass = getClass();</span><br><span class="line">        <span class="keyword">if</span> ((klass.isAnonymousClass() || klass.isMemberClass() || klass.isLocalClass()) &amp;&amp;</span><br><span class="line">                (klass.getModifiers() &amp; Modifier.STATIC) == <span class="number">0</span>) &#123;</span><br><span class="line">            Log.w(TAG, <span class="string">"The following Handler class should be static or leaks might occur: "</span> +</span><br><span class="line">                klass.getCanonicalName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mLooper = Looper.myLooper();</span><br><span class="line">    <span class="keyword">if</span> (mLooper == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">            <span class="string">"Can't create handler inside thread that has not called Looper.prepare()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    mQueue = mLooper.mQueue;</span><br><span class="line">    mCallback = callback;</span><br><span class="line">    mAsynchronous = async;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Use the provided &#123;<span class="doctag">@link</span> Looper&#125; instead of the default one and take a callback</span></span><br><span class="line"><span class="comment"> * interface in which to handle messages.  Also set whether the handler</span></span><br><span class="line"><span class="comment"> * should be asynchronous.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Handlers are synchronous by default unless this constructor is used to make</span></span><br><span class="line"><span class="comment"> * one that is strictly asynchronous.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Asynchronous messages represent interrupts or events that do not require global ordering</span></span><br><span class="line"><span class="comment"> * with respect to synchronous messages.  Asynchronous messages are not subject to</span></span><br><span class="line"><span class="comment"> * the synchronization barriers introduced by &#123;<span class="doctag">@link</span> MessageQueue#enqueueSyncBarrier(long)&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> looper The looper, must not be null.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> callback The callback interface in which to handle messages, or null.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> async If true, the handler calls &#123;<span class="doctag">@link</span> Message#setAsynchronous(boolean)&#125; for</span></span><br><span class="line"><span class="comment"> * each &#123;<span class="doctag">@link</span> Message&#125; that is sent to it or &#123;<span class="doctag">@link</span> Runnable&#125; that is posted to it.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@hide</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(Looper looper, Callback callback, <span class="keyword">boolean</span> async)</span> </span>&#123;</span><br><span class="line">    mLooper = looper;</span><br><span class="line">    mQueue = looper.mQueue;</span><br><span class="line">    mCallback = callback;</span><br><span class="line">    mAsynchronous = async;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Handler çš„æ„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ª Looper å¯¹è±¡ï¼Œå¦åˆ™å°†ä¼šè°ƒç”¨ <code>Looper.myLooper()</code> ä»å½“å‰çº¿ç¨‹å¯¹è±¡é‡Œå–å‡ºå‰é¢ <code>Looper.prepare()</code> å­˜çš„ Looper å¯¹è±¡ï¼Œä¹‹å Handler å°† Looper å’Œ MessageQueue ä½œä¸ºå¯¹è±¡æˆå‘˜ã€‚</p><p>æœ€åæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨ <code>Looper.loop()</code> æ¥å¯åŠ¨æ¶ˆæ¯å¾ªç¯äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Run the message queue in this thread. Be sure to call</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> #quit()&#125; to end the loop.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Looper me = myLooper();</span><br><span class="line">    <span class="keyword">if</span> (me == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"No Looper; Looper.prepare() wasn't called on this thread."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> MessageQueue queue = me.mQueue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make sure the identity of this thread is that of the local process,</span></span><br><span class="line">    <span class="comment">// and keep track of what that identity token actually is.</span></span><br><span class="line">    Binder.clearCallingIdentity();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">long</span> ident = Binder.clearCallingIdentity();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        Message msg = queue.next(); <span class="comment">// might block</span></span><br><span class="line">        <span class="keyword">if</span> (msg == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// No message indicates that the message queue is quitting.</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// This must be in a local variable, in case a UI event sets the logger</span></span><br><span class="line">        Printer logging = me.mLogging;</span><br><span class="line">        <span class="keyword">if</span> (logging != <span class="keyword">null</span>) &#123;</span><br><span class="line">            logging.println(<span class="string">"&gt;&gt;&gt;&gt;&gt; Dispatching to "</span> + msg.target + <span class="string">" "</span> +</span><br><span class="line">                    msg.callback + <span class="string">": "</span> + msg.what);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        msg.target.dispatchMessage(msg);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (logging != <span class="keyword">null</span>) &#123;</span><br><span class="line">            logging.println(<span class="string">"&lt;&lt;&lt;&lt;&lt; Finished to "</span> + msg.target + <span class="string">" "</span> + msg.callback);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Make sure that during the course of dispatching the</span></span><br><span class="line">        <span class="comment">// identity of the thread wasn't corrupted.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">long</span> newIdent = Binder.clearCallingIdentity();</span><br><span class="line">        <span class="keyword">if</span> (ident != newIdent) &#123;</span><br><span class="line">            Log.wtf(TAG, <span class="string">"Thread identity changed from 0x"</span></span><br><span class="line">                    + Long.toHexString(ident) + <span class="string">" to 0x"</span></span><br><span class="line">                    + Long.toHexString(newIdent) + <span class="string">" while dispatching to "</span></span><br><span class="line">                    + msg.target.getClass().getName() + <span class="string">" "</span></span><br><span class="line">                    + msg.callback + <span class="string">" what="</span> + msg.what);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        msg.recycleUnchecked();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Looper.loop()</code> ä¼šä»å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­æŠŠå‰é¢å­˜çš„ Looper å¯¹è±¡ä»¥åŠè¯¥å¯¹è±¡çš„ mMessageQueue å–å‡ºæ¥ï¼ˆè¿™é‡Œå–æ¶ˆæ¯æ˜¯é€šè¿‡è°ƒç”¨ MessageQueue çš„ <code>next()</code> æ–¹æ³•æ¥å–å¾—ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼‰ï¼Œç„¶åå¯åŠ¨æ¶ˆæ¯å¾ªç¯ï¼Œä¸åœåœ°ä» mMessageQueue é‡Œå–æ¶ˆæ¯å¹¶åˆ†æ´¾å¤„ç†ï¼Œä¹Ÿå°±æ˜¯ä¼šè°ƒç”¨æ¶ˆæ¯å¯¹åº”çš„ target Handler çš„ <code>dispathMessage()</code> æ–¹æ³•ï¼Œå½“ç„¶è¿™ä¸ªæ¶ˆæ¯å¤„ç†è¿‡ç¨‹å°±ä¸ <code>Looper.loop()</code> åœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œäº†ã€‚</p><h2 id="2-å‘ç›®æ ‡çº¿ç¨‹å‘æ¶ˆæ¯"><a href="#2-å‘ç›®æ ‡çº¿ç¨‹å‘æ¶ˆæ¯" class="headerlink" title="2. å‘ç›®æ ‡çº¿ç¨‹å‘æ¶ˆæ¯"></a>2. å‘ç›®æ ‡çº¿ç¨‹å‘æ¶ˆæ¯</h2><p>åœ¨ Android ä¸­æˆ‘ä»¬ä½¿ç”¨ Handler æ¥å®Œæˆçš„ã€‚æˆ‘ä»¬ä»å‰é¢å°±çŸ¥é“ Handler åœ¨åˆ›å»ºçš„æ—¶å€™å°±ä¼šæŒæœ‰ä¸€ä¸ª MessageQueue çš„å¼•ç”¨ï¼Œå…¶å®è¿™ä¸ªå°±æ˜¯ç”¨æ¥å¾€ MessageQueue é‡Œå‘æ¶ˆæ¯ç”¨çš„ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨ Handler å‘æ¶ˆæ¯æ—¶ï¼Œæœ€åéƒ½ä¼šè°ƒç”¨åˆ° Handler çš„ <code>enqueueMessage()</code> æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">enqueueMessage</span><span class="params">(MessageQueue queue, Message msg, <span class="keyword">long</span> uptimeMillis)</span> </span>&#123;</span><br><span class="line">    msg.target = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">if</span> (mAsynchronous) &#123;</span><br><span class="line">        msg.setAsynchronous(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> queue.enqueueMessage(msg, uptimeMillis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ Handler å°† Message çš„ target è®¾ç½®ä¸ºè‡ªå·±ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šäº†è¿™æ¡æ¶ˆæ¯å°†ä¼šç”±è‡ªå·±æ¥å¤„ç†ï¼Œç„¶åå°† Message æ”¾è¿› MessageQueue é‡Œé¢ã€‚</p><p>å› ä¸º MessageQueue çš„ <code>enqueueMessage()</code> æ–¹æ³•çš„æƒé™æ˜¯ package level çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œå°±éœ€è¦é€šè¿‡ Handler æ¥æŠŠæ¶ˆæ¯å‘åˆ° MessageQueue é‡Œã€‚</p><p>æ‰€ä»¥ Handler çš„ä½œç”¨ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯å¤„ç†æ¶ˆæ¯ï¼ŒäºŒæ˜¯ä½œä¸ºå‘æ¶ˆæ¯çš„ä¸€ä¸ªå·¥å…·ã€‚</p><h2 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3. æ€»ç»“"></a>3. æ€»ç»“</h2><p>é‚£ä¹ˆæ ¹æ®ä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><ul><li><p>ä¸€ä¸ª Looper å¯¹è±¡ä¸€å®šå¯¹åº”äºä¸€ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹æœ€å¤šæœ‰ä¸€ä¸ª Looper å¯¹è±¡</p></li><li><p>ä¸€ä¸ª Message æœ€ç»ˆç”±å®ƒçš„ target Handler æ¥å¤„ç†</p></li><li><p>ä¸€ä¸ª Message ä¼šåœ¨<strong>æŒæœ‰å®ƒæ‰€è¢«åŠ å…¥çš„ MessageQueue çš„ Looper å¯¹è±¡</strong>å¯¹åº”çš„çº¿ç¨‹ä¸­è¢«å¤„ç†</p></li></ul><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨å­çº¿ç¨‹ä¸­å®Œæˆäº†è€—æ—¶æ“ä½œæƒ³è¦åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ›´æ–° UI çš„æ—¶å€™ï¼Œæ€è·¯åº”è¯¥æ˜¯ï¼š</p><p><code>ä¸»çº¿ç¨‹ Looper çš„ MessageQueue -&gt; ä¸»çº¿ç¨‹ Looper -&gt; æ„é€ æŒæœ‰ä¸»çº¿ç¨‹ Looper çš„ Handlerï¼ˆnew Handler(Looper.getMainLooper())ï¼‰ -&gt; ä½¿ç”¨è¯¥ Handler å‘é€æ¶ˆæ¯</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Android ä¸­çº¿ç¨‹é—´é€šä¿¡æ¶ˆæ¯æœºåˆ¶çš„åŸºæœ¬æ€æƒ³å…¶å®å¾ˆç®€å•ï¼šä¸ºç›®æ ‡çº¿ç¨‹å»ºç«‹ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ç”¨æ¥â€œç›‘å¬â€æ¶ˆæ¯ï¼Œä¹‹åæˆ‘ä»¬åªè¦åœ¨å…¶ä»–çº¿ç¨‹ä¸­å‘ç›®æ ‡çº¿ç¨‹å‘é€æ¶ˆæ¯å°±å¯ä»¥è¢«ç›®æ ‡çº¿ç¨‹æ¥æ”¶å¹¶å¤„ç†ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åˆ†æè¿™ä¸ªæœºåˆ¶çš„å®ç°ï¼ˆä»¥ä¸‹æºç å‡åŸºäº SDK 23ï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Handler" scheme="https://wsxyeah.github.io/tags/Handler/"/>
    
  </entry>
  
  <entry>
    <title>é‡æ–°è®¤è¯† Activity LaunchMode</title>
    <link href="https://wsxyeah.github.io/2015/12/19/activity-launch-mode/"/>
    <id>https://wsxyeah.github.io/2015/12/19/activity-launch-mode/</id>
    <published>2015-12-19T08:43:40.000Z</published>
    <updated>2016-04-04T00:53:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>åš Android çš„åŒå­¦æƒ³å¿…å¯¹ activity å¯åŠ¨æ¨¡å¼éƒ½ä¸é™Œç”Ÿï¼Œactivity æœ‰å››ç§å¯åŠ¨æ¨¡å¼ï¼ˆ <code>standard</code>ï¼Œ<code>singleTop</code>ï¼Œ<code>singleTask</code>ï¼Œ<code>singleInstance</code>ï¼‰ï¼Œç½‘ä¸Šå’Œä¸€äº›ä¹¦ä¸Šä¹Ÿæœ‰å„ç§è®²è§£ï¼Œä½†è¿™äº›æ–‡ç« å¤§å¤šæ˜¯é’ˆå¯¹å››ç§å¯åŠ¨æ¨¡å¼è¿›è¡Œä»‹ç»ï¼Œæ€»æ˜¯åœ¨çœ‹è¿‡ä¸€æ®µæ—¶é—´åå°±å¿˜æ‰äº†ã€‚æœ¬æ–‡å¸Œæœ›å¸¦ä½ é‡æ–°ç†è§£ activity å¯åŠ¨æ¨¡å¼ï¼Œå¹¶ç†è§£ä¸€äº›å…¶ä»–çš„ç›¸å…³æ¦‚å¿µï¼Œè€Œä¸æ˜¯ä»…ä»…é’ˆå¯¹å››ç§å¯åŠ¨æ¨¡å¼ã€‚</p><a id="more"></a><h2 id="1-ä»-Task-è¯´èµ·"><a href="#1-ä»-Task-è¯´èµ·" class="headerlink" title="1. ä» Task è¯´èµ·"></a>1. ä» Task è¯´èµ·</h2><p>Activity å¯åŠ¨æ¨¡å¼æ˜¯ä¸ task å¯†åˆ‡ç›¸å…³çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä» task è¯´èµ·ã€‚</p><blockquote><p>A task is a collection of activities that users interact with when performing a certain job. The activities are arranged in a stack (the <em>back stack</em>), in the order in which each activity is opened.</p></blockquote><p>ä¸Šé¢è¿™å¥è¯æ˜¯å®˜æ–¹æ–‡æ¡£é‡Œçš„ï¼Œè§£é‡Šäº† Android ä¸­ task çš„æ¦‚å¿µï¼Œtask å°±æ˜¯è‹¥å¹² activity ç»„æˆçš„ä¸€ä¸ªé›†åˆï¼Œä»¥æ ˆçš„å½¢å¼æ¥ç®¡ç†ã€‚åœ¨ Android ä¸­ï¼Œæ¯ä¸ª activity éƒ½æ˜¯è¿è¡Œåœ¨ task ä¸­çš„ï¼Œå‰å° task çš„æ ˆé¡¶ activity ä½äºå‰å°ï¼Œå¯ä»¥ç›´æ¥ä¸ç”¨æˆ·äº¤äº’ã€‚</p><p>é‚£ä¹ˆä¸€ä¸ª activity è¿è¡Œåœ¨å“ªä¸ª task ä¸­æ˜¯ç”±è°æ¥å†³å®šçš„å‘¢ï¼Ÿæˆ‘ä»¬é¦–å…ˆæ¥çœ‹ taskAffinityï¼ŒtaskAffinity æ˜¯å½±å“ Activity è¿è¡Œåœ¨å“ªä¸ª task ä¸­çš„ç¬¬ä¸€ä¸ªå› ç´ ã€‚</p><p>ä¸€ä¸ª activity çš„ taskAffinity æ˜¯æˆ‘ä»¬åœ¨ <code>manifests.xml</code> é‡Œå®šä¹‰çš„ï¼Œæ¯ä¸ª Activity éƒ½å¯ä»¥è®¾ç½®ä¸€ä¸ª <code>android:taskAffinity</code> å±æ€§ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<code>application</code> å…ƒç´ ä¹Ÿæœ‰è¿™ä¸ªå±æ€§ï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯ <code>manifest</code> å…ƒç´ ä¸­æŒ‡å®šçš„åŒ…åï¼ˆ<code>package</code> å±æ€§ï¼‰ã€‚å¯¹äº Activity çš„è¿™ä¸ªå±æ€§ï¼Œå½“æˆ‘ä»¬ä¸æ˜¾å¼è®¾ç½®çš„æ—¶å€™å®ƒå°±ä¼šä» <code>application</code> å…ƒç´ ç»§æ‰¿ã€‚</p><p>é‚£ä¹ˆ<strong>åœ¨ taskAffinity å±æ€§èµ·ä½œç”¨</strong>çš„æƒ…å†µä¸‹ï¼Œé™¤äº† taskAffinity å€¼ä¸ºç©ºå­—ç¬¦ä¸²çš„ Activityï¼Œå…·æœ‰ç›¸åŒ taskAffinity çš„ Activity ä¼šè¿è¡Œåœ¨åŒä¸€ä¸ª task ä¸­ï¼Œå³ä½¿å®ƒä»¬å¤„äºä¸åŒçš„åº”ç”¨ä¸­ã€‚taskAffinity ä¸ºç©ºå­—ç¬¦ä¸²è¡¨ç¤ºè¿™ä¸ª Activity ä¸ä¼šä¸å…¶ä»–ä»»ä½• task å…³è”ã€‚</p><h2 id="2-manifests-xml-ä¸­çš„-launchMode"><a href="#2-manifests-xml-ä¸­çš„-launchMode" class="headerlink" title="2. manifests.xml ä¸­çš„ launchMode"></a>2. <code>manifests.xml</code> ä¸­çš„ launchMode</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨ <code>manifests.xml</code> ä¸­ä¸º activity æŒ‡å®š <code>android:launchMode</code> å±æ€§ï¼Œå¯ä»¥çš„å–å€¼æœ‰ <code>standard</code>ï¼Œ<code>singleTop</code>ï¼Œ<code>singleTask</code>ï¼Œ<code>singleInstance</code>ï¼Œé»˜è®¤å€¼æ˜¯ <code>standard</code>ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¸è®¾ç½® Intent flagsï¼ˆä¸‹æ–‡ä¼šè®²åˆ°ï¼‰çš„æƒ…å†µä¸‹å¯åŠ¨ä¸€ä¸ª activity çš„æ—¶å€™ï¼Œç³»ç»Ÿå°±ä¼šæ ¹æ® <code>manifests.xml</code> é‡Œè®¾ç½®çš„ launchMode æ¥å†³å®š activity å¯åŠ¨æ¨¡å¼ã€‚ä¸‹é¢æ˜¯å››ç§å¯åŠ¨æ¨¡å¼çš„å¤„ç†è¯´æ˜ã€‚</p><ul><li><p><code>standard</code>ï¼Œ<code>singleTop</code>ï¼šåœ¨å½“å‰ task ä¸­å¯åŠ¨ï¼Œ<strong>å¿½ç•¥ taskAffinity å±æ€§</strong>ã€‚<br>  ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«æ˜¯ <code>standard</code> æ¨¡å¼æ¯æ¬¡å¯åŠ¨éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼Œè€Œ <code>singleTop</code> æ¨¡å¼åˆ™æ˜¯è‹¥å·²ç»æœ‰è¯¥ activity çš„å®ä¾‹å­˜åœ¨äº task æ ˆé¡¶çš„æƒ…å†µä¸‹ä¸å†åˆ›å»ºæ–°å®ä¾‹ï¼Œè€Œæ˜¯å›è°ƒè¯¥å®ä¾‹çš„ <code>onNewIntent()</code> æ–¹æ³•ã€‚</p></li><li><p><code>singleTask</code>ï¼šè¿™æ—¶è¯¥ activity è¦åœ¨å“ªä¸ª task ä¸­è¿è¡Œå°±ç”±æˆ‘ä»¬å‰é¢æŒ‡å®šçš„ taskAffinity æ¥å†³å®šäº†ï¼ˆè¯¥ activity åªèƒ½è¿è¡Œåœ¨ taskAffinity ä¸è‡ªå·±çš„ taskAffinity ç›¸åŒçš„ task ä¸­ï¼‰ã€‚å¹¶ä¸”åœ¨è¿™ä¸ª task ä¸­è¯¥ activity çš„å®ä¾‹åªå…è®¸å­˜åœ¨ä¸€ä¸ªï¼Œè‹¥å·²ç»æœ‰ä¸€ä¸ªå®ä¾‹åœ¨æ ˆé¡¶ï¼Œå°±ä¼šå›è°ƒå®ƒçš„ <code>onNewIntent()</code> æ–¹æ³•ï¼›è‹¥æœ‰å®ä¾‹ä¸”ä¸åœ¨æ ˆé¡¶ï¼Œç³»ç»Ÿåˆ™ä¼šå°†è¯¥ task ä¸­è¯¥ä½äºè¯¥å®ä¾‹ä¹‹ä¸Šçš„ activity å‡ºæ ˆé”€æ¯ï¼Œä½¿è¯¥å®ä¾‹å›åˆ°å‰å°ï¼Œå¹¶å›è°ƒå…¶ <code>onNewIntent()</code> æ–¹æ³•ã€‚</p></li><li><p><code>singleInstance</code>ï¼šä¸ <code>singleTask</code> ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äº <code>singleInstance</code> çš„ task ä¸­åªèƒ½æœ‰ä¸€ä¸ª activity å®ä¾‹å­˜åœ¨ï¼Œå³è¯¥ activity åªèƒ½å•ç‹¬è¿è¡Œäºä¸€ä¸ª task ä¸­ã€‚</p></li></ul><h2 id="3-Intent-flag"><a href="#3-Intent-flag" class="headerlink" title="3. Intent flag"></a>3. Intent flag</h2><p>å½±å“ activity å¯åŠ¨æ¨¡å¼çš„å¦ä¸€ä¸ªåœ°æ–¹å°±æ˜¯ Intent flag äº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨ Intent å¯åŠ¨ä¸€ä¸ª activity çš„æ—¶å€™å¯ä»¥è°ƒç”¨ Intent çš„ <code>setFlag()</code> æ–¹æ³•æ¥ä¸ºå®ƒè®¾ç½®æ ‡å¿—ä½ï¼Œä¸” Intent flag å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚å½±å“ activity å¯åŠ¨æ¨¡å¼çš„ Intent flag æœ‰ä¸‹é¢å‡ ä¸ªã€‚</p><ul><li><p><code>FLAG_ACTIVITY_NEW_TASK</code>ï¼šåœ¨æ–° task ä¸­å¯åŠ¨ activityï¼Œæ•ˆæœä¸ <code>singleTask</code> æ¨¡å¼ç±»ä¼¼ï¼Œä½†ä¸ä¼šæ¸…é™¤ç›®æ ‡ activity ä¹‹ä¸Šçš„ activityã€‚ä½¿ç”¨è¿™ä¸ª flag å¯ä»¥å®ç°åº”ç”¨é—´åˆ‡æ¢çš„æ•ˆæœã€‚</p></li><li><p><code>FLAG_ACTIVITY_SINGLE_TOP</code>ï¼šä¸ <code>singleTop</code> æ¨¡å¼æ•ˆæœç›¸åŒã€‚</p></li><li><p><code>FLAG_ACTIVITY_CLEAR_TOP</code>ï¼šè‹¥ç›®æ ‡ activity åœ¨å…¶ task ä¸­å·²ç»æœ‰å®ä¾‹å­˜åœ¨ï¼Œåˆ™å°† task ä¸­å…¶ä¸Šçš„ activity å‡ºæ ˆé”€æ¯ï¼Œä½¿è¯¥å®ä¾‹å›åˆ°å‰å°ï¼Œå¹¶å›è°ƒå…¶ <code>onNewIntent()</code> æ–¹æ³•ã€‚ä¸ <code>FLAG_ACTIVITY_NEW_TASK</code> ç»“åˆä½¿ç”¨å¯ä»¥å®ç° <code>singleTask</code> æ¨¡å¼çš„æ•ˆæœã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åš Android çš„åŒå­¦æƒ³å¿…å¯¹ activity å¯åŠ¨æ¨¡å¼éƒ½ä¸é™Œç”Ÿï¼Œactivity æœ‰å››ç§å¯åŠ¨æ¨¡å¼ï¼ˆ &lt;code&gt;standard&lt;/code&gt;ï¼Œ&lt;code&gt;singleTop&lt;/code&gt;ï¼Œ&lt;code&gt;singleTask&lt;/code&gt;ï¼Œ&lt;code&gt;singleInstance&lt;/code&gt;ï¼‰ï¼Œç½‘ä¸Šå’Œä¸€äº›ä¹¦ä¸Šä¹Ÿæœ‰å„ç§è®²è§£ï¼Œä½†è¿™äº›æ–‡ç« å¤§å¤šæ˜¯é’ˆå¯¹å››ç§å¯åŠ¨æ¨¡å¼è¿›è¡Œä»‹ç»ï¼Œæ€»æ˜¯åœ¨çœ‹è¿‡ä¸€æ®µæ—¶é—´åå°±å¿˜æ‰äº†ã€‚æœ¬æ–‡å¸Œæœ›å¸¦ä½ é‡æ–°ç†è§£ activity å¯åŠ¨æ¨¡å¼ï¼Œå¹¶ç†è§£ä¸€äº›å…¶ä»–çš„ç›¸å…³æ¦‚å¿µï¼Œè€Œä¸æ˜¯ä»…ä»…é’ˆå¯¹å››ç§å¯åŠ¨æ¨¡å¼ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="LaunchMode" scheme="https://wsxyeah.github.io/tags/LaunchMode/"/>
    
  </entry>
  
  <entry>
    <title>Android NDK å¼€å‘ç¯å¢ƒæ­å»º</title>
    <link href="https://wsxyeah.github.io/2015/12/06/android-ndk-start/"/>
    <id>https://wsxyeah.github.io/2015/12/06/android-ndk-start/</id>
    <published>2015-12-06T03:10:08.000Z</published>
    <updated>2016-04-04T00:22:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ä¹Ÿæ›¾çœ‹è¿‡ä¸€äº›ä»‹ç» NDK çš„æ–‡ç« ï¼Œä½†æ˜¯ç”±äºå«Œï¼ˆtuoï¼‰éº»ï¼ˆyanï¼‰çƒ¦ï¼ˆzhengï¼‰ä¸€ç›´æ²¡æœ‰å®è·µè¿‡ï¼Œè¿™ä¸¤å¤©è¯»äº†äº›æ–‡ç« å’Œæ–‡æ¡£ï¼Œæ‰“ç®—æŠŠ NDK çš„é¡¹ç›®æ­å»ºçš„ä¸€äº›ä¸œè¥¿æ•´ç†ä¸€ä¸‹ã€‚</p><p>æœ¬æ–‡ä¸»è¦ä»‹ç» Eclipse ä¸‹å’Œ Android Studio ä¸‹ NDK å¼€å‘ç¯å¢ƒçš„æ­å»ºã€‚</p><a id="more"></a><h2 id="1-NDK-ä¸‹è½½"><a href="#1-NDK-ä¸‹è½½" class="headerlink" title="1. NDK ä¸‹è½½"></a>1. NDK ä¸‹è½½</h2><p><a href="http://developer.android.com/ndk/downloads/index.html" target="_blank" rel="noopener">http://developer.android.com/ndk/downloads/index.html</a></p><p>åœ¨è¿™é‡Œæ ¹æ®å¹³å°é€‰æ‹©ç›¸åº”çš„æ–‡ä»¶ä¸‹è½½ã€‚</p><ul><li><p>Windows ä¸‹é¢å¯ä»¥ç›´æ¥åŒå‡»ä¸‹è½½çš„ exe æ–‡ä»¶è§£å‹ã€‚</p></li><li><p>Linux å’Œ OS X ç”¨æˆ·éœ€è¦è¿›å…¥ä¸‹è½½çš„æ–‡ä»¶ç›®å½•ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è§£å‹ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x android-ndk-r10c-darwin-x86_64.bin</span><br><span class="line">./android-ndk-r10c-darwin-x86_64.bin</span><br></pre></td></tr></table></figure><h2 id="2-ç¯å¢ƒå˜é‡é…ç½®"><a href="#2-ç¯å¢ƒå˜é‡é…ç½®" class="headerlink" title="2. ç¯å¢ƒå˜é‡é…ç½®"></a>2. ç¯å¢ƒå˜é‡é…ç½®</h2><p>åªè¦æŠŠ NDK ç›®å½•åŠ å…¥åˆ°ç³»ç»Ÿ PATH å˜é‡å°±å¥½äº†ï¼Œè¿™æ­¥æ˜¯ä¸ºäº†æ–¹ä¾¿ä»å‘½ä»¤è¡Œæ‰§è¡Œ NDK è„šæœ¬ã€‚</p><h2 id="3-Eclipse-ä¸‹-NDK-é¡¹ç›®æ­å»º"><a href="#3-Eclipse-ä¸‹-NDK-é¡¹ç›®æ­å»º" class="headerlink" title="3. Eclipse ä¸‹ NDK é¡¹ç›®æ­å»º"></a>3. Eclipse ä¸‹ NDK é¡¹ç›®æ­å»º</h2><h3 id="1-é¦–å…ˆåœ¨-Eclipse-çš„è®¾ç½®é‡Œé€‰æ‹©-NDK-ç›®å½•ã€‚"><a href="#1-é¦–å…ˆåœ¨-Eclipse-çš„è®¾ç½®é‡Œé€‰æ‹©-NDK-ç›®å½•ã€‚" class="headerlink" title="1. é¦–å…ˆåœ¨ Eclipse çš„è®¾ç½®é‡Œé€‰æ‹© NDK ç›®å½•ã€‚"></a>1. é¦–å…ˆåœ¨ Eclipse çš„è®¾ç½®é‡Œé€‰æ‹© NDK ç›®å½•ã€‚</h3><p><code>Android &gt; NDK &gt; NDK Location</code></p><h3 id="2-æ–°å»º-Android-é¡¹ç›®"><a href="#2-æ–°å»º-Android-é¡¹ç›®" class="headerlink" title="2. æ–°å»º Android é¡¹ç›®"></a>2. æ–°å»º Android é¡¹ç›®</h3><h3 id="3-æ·»åŠ -native-æ–¹æ³•"><a href="#3-æ·»åŠ -native-æ–¹æ³•" class="headerlink" title="3. æ·»åŠ  native æ–¹æ³•"></a>3. æ·»åŠ  native æ–¹æ³•</h3><p>native æ–¹æ³•åœ¨æ–¹æ³•ç­¾åå‰åŠ  <code>native</code> å…³é”®å­—ï¼Œæ— æ–¹æ³•ä½“ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">yo</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><h3 id="4-ä¸ºé¡¹ç›®æ·»åŠ -NDK-æ”¯æŒ"><a href="#4-ä¸ºé¡¹ç›®æ·»åŠ -NDK-æ”¯æŒ" class="headerlink" title="4. ä¸ºé¡¹ç›®æ·»åŠ  NDK æ”¯æŒ"></a>4. ä¸ºé¡¹ç›®æ·»åŠ  NDK æ”¯æŒ</h3><p>åœ¨å·¦ä¾§é¡¹ç›®è§†å›¾ä¸Šç‚¹å‡»å³é”®ï¼Œé€‰æ‹© Android Tools -&gt; Add Native Supportâ€¦ï¼Œç„¶åè¾“å…¥ Library Nameï¼šlibxxx.soï¼ŒFinishã€‚</p><p>ä¹‹å Eclipse ä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆ jni ç›®å½•ä»¥åŠ <code>Android.mk</code>ï¼Œ<code>xxx.cpp</code> ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><h3 id="5-ç”Ÿæˆ-jni-å¤´æ–‡ä»¶"><a href="#5-ç”Ÿæˆ-jni-å¤´æ–‡ä»¶" class="headerlink" title="5. ç”Ÿæˆ jni å¤´æ–‡ä»¶"></a>5. ç”Ÿæˆ jni å¤´æ–‡ä»¶</h3><p>åœ¨ Eclipse ä¸­æ‰§è¡Œ build å‘½ä»¤ï¼Œç„¶åè¿›å…¥åˆ°é¡¹ç›®çš„ <code>bin\classes</code> ç›®å½•ï¼Œæ‰§è¡Œ <code>javah -cp å®Œæ•´ç±»å android.jar</code> å‘½ä»¤ï¼Œå…¶ä¸­å®Œæ•´çš„ç±»åæ˜¯æŒ‡åŒ…å«åŒ…åï¼Œ<code>android.jar</code> æ˜¯ SDK ç›®å½•ä¸‹å¯¹åº”çš„ compile SDK ç‰ˆæœ¬ç›®å½•ä¸‹é¢çš„ android.jar çš„è·¯å¾„ï¼Œæ¯”å¦‚æˆ‘çš„ compile SDK ç‰ˆæœ¬æ˜¯ 23ï¼Œé‚£æˆ‘çš„è·¯å¾„å°±æ˜¯ <code>SDKç›®å½•\platforms\android-23\android.jar</code>ã€‚æ­¤æ—¶ä¼š javah ä¼šä¸ºæˆ‘ä»¬åœ¨ classes ç›®å½•ä¸‹ç”Ÿæˆ jni å¤´æ–‡ä»¶ã€‚</p><h3 id="6-æ ¹æ®-jni-å¤´æ–‡ä»¶åœ¨-xxx-cpp-ä¸­ç¼–å†™-native-ä»£ç "><a href="#6-æ ¹æ®-jni-å¤´æ–‡ä»¶åœ¨-xxx-cpp-ä¸­ç¼–å†™-native-ä»£ç " class="headerlink" title="6. æ ¹æ® jni å¤´æ–‡ä»¶åœ¨ xxx.cpp ä¸­ç¼–å†™ native ä»£ç "></a>6. æ ¹æ® jni å¤´æ–‡ä»¶åœ¨ xxx.cpp ä¸­ç¼–å†™ native ä»£ç </h3><p>æ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä½¿ç”¨ C++ ç¼–å†™ï¼Œéœ€è¦å®šä¹‰ <code>extern &quot;C&quot;</code> å®ã€‚</p><p>å…³äº <code>extern &quot;C&quot;</code> çš„è¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="http://www.jianshu.com/p/5d2eeeb93590" target="_blank" rel="noopener">extern â€œcâ€ç”¨æ³•è§£æ</a>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* Class:     me_sxwang_jnipractice_MainActivity</span></span><br><span class="line"><span class="comment">* Method:    yo</span></span><br><span class="line"><span class="comment">* Signature: ()Ljava/lang/String;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">JNIEXPORT jstring JNICALL Java_me_sxwang_jnipractice_MainActivity_yo</span><br><span class="line">(JNIEnv *env, jobject thiz) &#123;</span><br><span class="line"><span class="keyword">return</span> env-&gt;NewStringUTF(<span class="string">"I come from JNI."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><h3 id="7-ç¼–è¯‘-native-ä»£ç "><a href="#7-ç¼–è¯‘-native-ä»£ç " class="headerlink" title="7. ç¼–è¯‘ native ä»£ç "></a>7. ç¼–è¯‘ native ä»£ç </h3><p>è¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œä½¿ç”¨ <code>ndk-build</code> å‘½ä»¤æ‰§è¡Œç¼–è¯‘ï¼Œç¼–è¯‘å®Œæˆåä¼šåœ¨é¡¹ç›®çš„ <code>libs</code> ç›®å½•ä¸‹ç”Ÿæˆç›¸åº”çš„ so æ–‡ä»¶ã€‚</p><h3 id="8-åŠ è½½-jni-åº“ï¼Œè¿è¡Œè°ƒè¯•"><a href="#8-åŠ è½½-jni-åº“ï¼Œè¿è¡Œè°ƒè¯•" class="headerlink" title="8. åŠ è½½ jni åº“ï¼Œè¿è¡Œè°ƒè¯•"></a>8. åŠ è½½ jni åº“ï¼Œè¿è¡Œè°ƒè¯•</h3><p>åœ¨ç±»ä¸­æ·»åŠ åˆå§‹åŒ–ä»£ç æ®µåŠ è½½ jni åº“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">System.loadLibrary(<span class="string">"xxx"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-Android-Studio-ä¸‹-NDK-é¡¹ç›®æ­å»ºï¼ˆåŸºäº-Android-Studio-1-5ï¼‰"><a href="#4-Android-Studio-ä¸‹-NDK-é¡¹ç›®æ­å»ºï¼ˆåŸºäº-Android-Studio-1-5ï¼‰" class="headerlink" title="4. Android Studio ä¸‹ NDK é¡¹ç›®æ­å»ºï¼ˆåŸºäº Android Studio 1.5ï¼‰"></a>4. Android Studio ä¸‹ NDK é¡¹ç›®æ­å»ºï¼ˆåŸºäº Android Studio 1.5ï¼‰</h2><h3 id="1-æ–°å»º-Android-é¡¹ç›®"><a href="#1-æ–°å»º-Android-é¡¹ç›®" class="headerlink" title="1. æ–°å»º Android é¡¹ç›®"></a>1. æ–°å»º Android é¡¹ç›®</h3><h3 id="2-åœ¨é¡¹ç›®çš„-Project-Structure-ä¸­é€‰æ‹©-NDK-æ‰€åœ¨ç›®å½•"><a href="#2-åœ¨é¡¹ç›®çš„-Project-Structure-ä¸­é€‰æ‹©-NDK-æ‰€åœ¨ç›®å½•" class="headerlink" title="2. åœ¨é¡¹ç›®çš„ Project Structure ä¸­é€‰æ‹© NDK æ‰€åœ¨ç›®å½•"></a>2. åœ¨é¡¹ç›®çš„ Project Structure ä¸­é€‰æ‹© NDK æ‰€åœ¨ç›®å½•</h3><h3 id="3-ä¸º-build-gradle-Module-app-æ·»åŠ -NDK-æ¨¡å—"><a href="#3-ä¸º-build-gradle-Module-app-æ·»åŠ -NDK-æ¨¡å—" class="headerlink" title="3. ä¸º build.gradle (Module: app) æ·»åŠ  NDK æ¨¡å—"></a>3. ä¸º <code>build.gradle (Module: app)</code> æ·»åŠ  NDK æ¨¡å—</h3><p><del>åœ¨ android &gt; defaultConfig ä¸‹æ–°å¢å¦‚ä¸‹ç‰‡æ®µï¼Œæ‰§è¡Œ buildï¼Œä¼šæç¤ºéœ€è¦åœ¨ gradle.properties æ·»åŠ  <code>android.useDeprecatedNdk=true</code>ï¼Œæ ¹æ®æç¤ºæ·»åŠ å®Œåé‡æ–° build ä¸€ä¸‹ã€‚</del></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ndk &#123;</span><br><span class="line">moduleName &quot;xxx&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <a href="">https://bintray.com/android/android-tools/com.android.tools.build.gradle-experimental/view</a> æŸ¥çœ‹ gradle-experimental æ’ä»¶çš„æœ€æ–°ç‰ˆï¼Œå¹¶åœ¨ Project çš„ buildscript&gt;dependencies classpath ä¸­æ›¿æ¢åŸæœ‰çš„æ’ä»¶ã€‚<br>å¯ç”¨ gralde-experimental éœ€è¦ä¿®æ”¹ module çš„é…ç½®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &apos;com.android.model.application&apos;</span><br><span class="line">model &#123;</span><br><span class="line">android &#123;</span><br><span class="line">compileSdkVersion = 23</span><br><span class="line">buildToolsVersion = &quot;23.0.1&quot;</span><br><span class="line"></span><br><span class="line">defaultConfig.with &#123;</span><br><span class="line">applicationId = &quot;com.google.sample.helloandroidjni&quot;</span><br><span class="line">minSdkVersion.apiLevel = 22</span><br><span class="line">targetSdkVersion.apiLevel = 23</span><br><span class="line">versionCode = 1</span><br><span class="line">versionName = &quot;1.0&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">android.buildTypes &#123;</span><br><span class="line">release &#123;</span><br><span class="line">minifyEnabled = false</span><br><span class="line">proguardFiles.add(file(&apos;proguard-android.txt&apos;))</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-åˆ›å»º-native-æ–¹æ³•"><a href="#4-åˆ›å»º-native-æ–¹æ³•" class="headerlink" title="4. åˆ›å»º native æ–¹æ³•"></a>4. åˆ›å»º native æ–¹æ³•</h3><p>åŒ Eclipse</p><h3 id="5-ç”Ÿæˆ-jni-æ–‡ä»¶"><a href="#5-ç”Ÿæˆ-jni-æ–‡ä»¶" class="headerlink" title="5. ç”Ÿæˆ jni æ–‡ä»¶"></a>5. ç”Ÿæˆ jni æ–‡ä»¶</h3><p>åœ¨ native æ–¹æ³•åä¸Šï¼ŒæŒ‰ <code>Option ï¼‹ Enter</code> é”®æ ¹æ®æç¤ºé€‰æ‹©ç¬¬ä¸€é¡¹ Create function â€¦ï¼ŒAndroid Studio ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆç›¸åº”çš„ c æ–‡ä»¶ï¼ŒåŠæ–¹æ³•ç­¾åç­‰ä¿¡æ¯ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç¼–å†™ native ä»£ç ã€‚</p><h3 id="6-ç¼–å†™-native-ä»£ç ï¼ŒåŠ è½½-jni-åº“ï¼Œè¿è¡Œè°ƒè¯•"><a href="#6-ç¼–å†™-native-ä»£ç ï¼ŒåŠ è½½-jni-åº“ï¼Œè¿è¡Œè°ƒè¯•" class="headerlink" title="6. ç¼–å†™ native ä»£ç ï¼ŒåŠ è½½ jni åº“ï¼Œè¿è¡Œè°ƒè¯•"></a>6. ç¼–å†™ native ä»£ç ï¼ŒåŠ è½½ jni åº“ï¼Œè¿è¡Œè°ƒè¯•</h3><p>åŒ Eclipseï¼ŒAndroid Studio ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç¼–è¯‘ native ä»£ç ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–è¯‘</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ä¹Ÿæ›¾çœ‹è¿‡ä¸€äº›ä»‹ç» NDK çš„æ–‡ç« ï¼Œä½†æ˜¯ç”±äºå«Œï¼ˆtuoï¼‰éº»ï¼ˆyanï¼‰çƒ¦ï¼ˆzhengï¼‰ä¸€ç›´æ²¡æœ‰å®è·µè¿‡ï¼Œè¿™ä¸¤å¤©è¯»äº†äº›æ–‡ç« å’Œæ–‡æ¡£ï¼Œæ‰“ç®—æŠŠ NDK çš„é¡¹ç›®æ­å»ºçš„ä¸€äº›ä¸œè¥¿æ•´ç†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç» Eclipse ä¸‹å’Œ Android Studio ä¸‹ NDK å¼€å‘ç¯å¢ƒçš„æ­å»ºã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="NDK" scheme="https://wsxyeah.github.io/tags/NDK/"/>
    
  </entry>
  
  <entry>
    <title>Android å¼‚æ­¥åŠ è½½æ•°æ®æ–¹å¼æ•´ç†</title>
    <link href="https://wsxyeah.github.io/2015/11/22/android-async/"/>
    <id>https://wsxyeah.github.io/2015/11/22/android-async/</id>
    <published>2015-11-22T02:43:12.000Z</published>
    <updated>2016-07-23T10:01:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ Android ä¸­ï¼Œç”±äºä¸»çº¿ç¨‹è´Ÿè´£ç»´æŠ¤ UIï¼Œä¸èƒ½è¢«é˜»å¡ï¼Œé‚£ä¹ˆåœ¨é€šè¿‡ç£ç›˜æˆ–è€…ç½‘ç»œè¿›è¡Œå¼‚æ­¥åŠ è½½æ•°æ®çš„æ—¶å€™å°±éœ€è¦ä½¿ç”¨å¤šçº¿ç¨‹äº†ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ•´ç†çš„å‡ ç§ä½¿ç”¨å¤šçº¿ç¨‹æ‰§è¡Œå¼‚æ­¥æ“ä½œçš„æ–¹å¼ï¼Œå¦‚æœ‰çº°æ¼æ¬¢è¿æŒ‡æ­£ã€‚</p><a id="more"></a><h2 id="1-Handler"><a href="#1-Handler" class="headerlink" title="1. Handler"></a>1. Handler</h2><p>   Android ä¸­å¤šçº¿ç¨‹é€šä¿¡åŸºæœ¬çš„æ–¹å¼æ˜¯ä½¿ç”¨ Handler æœºåˆ¶ï¼ŒåŸºæœ¬ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ã€‚</p>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//init handler on the original thread</span><br><span class="line">class OriginalThread extends Thread &#123;</span><br><span class="line"> public Handler mHandler;</span><br><span class="line"> public void run() &#123;</span><br><span class="line">   Looper.prepare();</span><br><span class="line">   mHandler = new Handler() &#123;</span><br><span class="line">     public void handleMessage(Message msg) &#123;</span><br><span class="line">     // process incoming messages here</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;;</span><br><span class="line">   Looper.loop();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">//send message to the original thread</span><br><span class="line">mHandler.post(Runnable);</span><br><span class="line">mHandler.postAtTime(Runnable, long);</span><br><span class="line">mHandler.postDelayed(Runnable, long);</span><br><span class="line">mHandler.sendEmptyMessage(int);</span><br><span class="line">mHandler.sendMessage(Message);</span><br><span class="line">mHandler.sendMessageAtTime(Message, long);</span><br><span class="line">mHandler.sendMessageDelayed(Message, long);</span><br></pre></td></tr></table></figure><p>   ç³»ç»Ÿè¿˜å†…ç½®äº†AsyncQueryHandler è¾…åŠ©å­ç±»ï¼Œæ–¹ä¾¿ä½¿ç”¨ ContentResolver è¿›è¡Œå¼‚æ­¥æŸ¥è¯¢æ“ä½œã€‚</p><p>   å…³äº Handlerï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ Handler è¢«å£°æ˜ä¸º Activity çš„éé™æ€å†…éƒ¨ç±»æ—¶ï¼Œ Handler ä¼šæŒæœ‰å¤–éƒ¨ Activity å®ä¾‹çš„å¼•ç”¨ï¼ŒHandler ç”Ÿå‘½å‘¨æœŸæ¯” Activity é•¿æ—¶ä¼šå¯¼è‡´ Activity å®ä¾‹ä¸èƒ½è¢«æ­£å¸¸é‡Šæ”¾ï¼Œä»è€Œå¼•èµ·å†…å­˜æ³„æ¼ã€‚ä¸€ç§è§£å†³æ–¹å¼æ˜¯å°† Handler å£°æ˜ä¸º Activity çš„é™æ€å†…éƒ¨ç±»æˆ–è€…å•ç‹¬çš„ç±»ï¼Œåœ¨ Handler å†…éƒ¨ä½¿ç”¨ WeakReference/SoftReference ä¿å­˜å¯¹ Activityçš„å¼•ç”¨ï¼Œæ—¢èƒ½è®¿é—® Activity çš„ View æ›´æ–° UIï¼Œåˆå¯ä»¥é¿å…å†…å­˜æ³„æ¼ã€‚</p><h2 id="2-AsyncTask"><a href="#2-AsyncTask" class="headerlink" title="2. AsyncTask"></a>2. AsyncTask</h2><p>   AsyncTask æ–¹å¼æ˜¯å®˜æ–¹æä¾›çš„ç”¨æ¥ç®€åŒ–æ‰‹åŠ¨å†™ Handler çš„ä¸€ç§å¼‚æ­¥æœºåˆ¶ï¼Œå…¶å†…éƒ¨ä»ä½¿ç”¨ Handler å®ç°ã€‚</p><p>   éœ€è¦ç»§æ‰¿AsyncTask&lt;Params, Progress, Result&gt;ç±»ï¼Œé‡å†™doInBackgroundï¼ŒonPostExecuteç­‰å›è°ƒæ–¹æ³•ï¼Œä½¿ç”¨çš„æ—¶å€™è°ƒç”¨ execute æ–¹æ³•ï¼ˆåªèƒ½åœ¨ UI çº¿ç¨‹è°ƒç”¨ï¼‰ä¼ å…¥å‚æ•°å°±å¯ä»¥æ–¹ä¾¿çš„æ‰§è¡Œ IO æˆ–ç½‘ç»œç­‰è€—æ—¶æ“ä½œå¹¶åœ¨æ“ä½œå®Œæˆæ—¶æ›´æ–° UIã€‚</p><p>   ä½¿ç”¨ AsyncTask åŒæ ·éœ€è¦æ³¨æ„å†…å­˜æ³„æ¼é—®é¢˜ã€‚</p><h2 id="3-Activity-runOnUiThread-Runnable-action"><a href="#3-Activity-runOnUiThread-Runnable-action" class="headerlink" title="3. Activity.runOnUiThread(Runnable action)"></a>3. Activity.runOnUiThread(Runnable action)</h2><p>   ç®—æ˜¯ Handler æ–¹å¼çš„ä¸€ç§è¯­æ³•ç³–å§ï¼Œä½¿ç”¨äº† Activity è‡ªèº«ç»´æŠ¤çš„ ä¸€ä¸ª mHandler å®ä¾‹ï¼Œä¾¿äºåœ¨ UI çº¿ç¨‹æ‰§è¡Œæ“ä½œï¼Œæ¯”å¦‚å¼‚æ­¥è·å–æ•°æ®åæ›´æ–° UIã€‚</p><h2 id="4-Loader"><a href="#4-Loader" class="headerlink" title="4. Loader"></a>4. Loader</h2><p>   Loader æ˜¯åœ¨ Android 3.0 å¼•å…¥çš„ç”¨äºåœ¨ Activity å’Œ Fragment ä¸­ç®€åŒ–å¼‚æ­¥åŠ è½½æ•°æ®çš„æ–¹å¼ã€‚</p><p>   ç³»ç»Ÿæä¾›äº† AsyncTaskLoader<d> å’Œ CursorLoader ä¸¤ä¸ªå­ç±»ã€‚</d></p><h2 id="5-View-post-Runnable-action-View-postDelayed-Runnable-action-long-delayMillis"><a href="#5-View-post-Runnable-action-View-postDelayed-Runnable-action-long-delayMillis" class="headerlink" title="5. View.post(Runnable action)/View.postDelayed(Runnable action, long delayMillis)"></a>5. View.post(Runnable action)/View.postDelayed(Runnable action, long delayMillis)</h2><h2 id="6-RxJava"><a href="#6-RxJava" class="headerlink" title="6. RxJava"></a>6. RxJava</h2><p>   ä½¿ç”¨ RxJava å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œå¤šçº¿ç¨‹è°ƒåº¦ï¼Œé€šè¿‡è°ƒç”¨ Observable.subscribeOn å’Œ Observable.observeOnï¼Œå¹¶ä½¿ç”¨ Schedulers.io() å’Œ Schedulers.mainThread() ç­‰å·¥å‚æ–¹æ³•ä¼ å…¥å‚æ•°å³å¯è‡ªç”±åˆ‡æ¢çº¿ç¨‹ã€‚</p><h2 id="7-EventBus"><a href="#7-EventBus" class="headerlink" title="7. EventBus"></a>7. EventBus</h2><p>   ä½¿ç”¨ EventBus å¯ä»¥åœ¨ä»»æ„çº¿ç¨‹å‘å¸ƒæ•°æ®ï¼Œå¹¶é€šè¿‡è®¢é˜…æ–¹æ³•çš„å‘½åçº¦å®šè§„å®šåœ¨ä½•ç§çº¿ç¨‹æ‰§è¡Œè®¢é˜…çš„å›è°ƒæ–¹æ³•ã€‚</p>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// Called in the same thread (default)</span><br><span class="line">public void onEvent(MessageEvent event) &#123;</span><br><span class="line">log(event.message);</span><br><span class="line">&#125;</span><br><span class="line">// Called in Android UI&apos;s main thread</span><br><span class="line">public void onEventMainThread(MessageEvent event) &#123;</span><br><span class="line">textField.setText(event.message);</span><br><span class="line">&#125;</span><br><span class="line">// Called in the background thread</span><br><span class="line">public void onEventBackgroundThread(MessageEvent event)&#123;</span><br><span class="line">saveToDisk(event.message);</span><br><span class="line">&#125;</span><br><span class="line">// Called in a separate thread</span><br><span class="line">public void onEventAsync(MessageEvent event)&#123;</span><br><span class="line">backend.send(event.message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ Android ä¸­ï¼Œç”±äºä¸»çº¿ç¨‹è´Ÿè´£ç»´æŠ¤ UIï¼Œä¸èƒ½è¢«é˜»å¡ï¼Œé‚£ä¹ˆåœ¨é€šè¿‡ç£ç›˜æˆ–è€…ç½‘ç»œè¿›è¡Œå¼‚æ­¥åŠ è½½æ•°æ®çš„æ—¶å€™å°±éœ€è¦ä½¿ç”¨å¤šçº¿ç¨‹äº†ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ•´ç†çš„å‡ ç§ä½¿ç”¨å¤šçº¿ç¨‹æ‰§è¡Œå¼‚æ­¥æ“ä½œçš„æ–¹å¼ï¼Œå¦‚æœ‰çº°æ¼æ¬¢è¿æŒ‡æ­£ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Async" scheme="https://wsxyeah.github.io/tags/Async/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://wsxyeah.github.io/2015/11/06/hello-world/"/>
    <id>https://wsxyeah.github.io/2015/11/06/hello-world/</id>
    <published>2015-11-06T02:47:20.000Z</published>
    <updated>2016-04-04T00:23:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;http://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;http://hexo.io
      
    
    </summary>
    
    
  </entry>
  
</feed>
